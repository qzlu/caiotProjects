!function(L,n){"use strict";var C="position",u="absolute",M="relative",a="px",H="left",l="right",B="top",x="bottom",T="display",Y="none",A="block",r=ht.Default,J=r.getInternal(),p=Math.floor,h=Math.ceil,m=Math.PI,k=null,Q=L.parseInt,I=function(c){return c.getContext("2d")},F=function(){return document},g=function($){return F().createElement($)},q=function(){return g("canvas")},S=function(H,q,z){H.style.setProperty(q,z,k)},y=function(l,E,Z){r.def(ht.widget[l],E,Z)},c=function(s,D){s.appendChild(D)},j=function(L,s){L.removeChild(s)},D=r.eventListenerOptionsFalse,v=(r.eventListenerOptionsTrue,function(O,I,K,Z){O.addEventListener(I,K,Z?D:D)}),R=function(C,p,F,v){C.removeEventListener(p,F,v?D:D)};ht.widget.RulerFrame=function(Z){var L=this,h=L._view=J.createView(null,L),V=L.$1k=q(),k=L.$2k=q(),r=L.$3k=q(),P=L.$4k=q();L._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},L._topRulerConfig={visible:!0},L._rightRulerConfig={visible:!1},L._bottomRulerConfig={visible:!1},L._leftRulerConfig={visible:!0},c(h,V),c(h,r),c(h,k),c(h,P),S(h,C,M),S(h,"box-sizing","border-box"),S(h,"-moz-box-sizing","border-box"),S(V,C,u),S(k,C,u),S(r,C,u),S(P,C,u),L.$14k=function(){L.$13k=1,L.iv()},L.$15k=function(Q){if(L._topRulerConfig.guideVisible||L._rightRulerConfig.guideVisible||L._bottomRulerConfig.guideVisible||L._leftRulerConfig.guideVisible||L._defaultRulerConfig.guideVisible||(L._topRulerConfig.guideTipVisible||L._rightRulerConfig.guideTipVisible||L._bottomRulerConfig.guideTipVisible||L._leftRulerConfig.guideTipVisible||L._defaultRulerConfig.guideTipVisible)&&L._component){var W=h.getBoundingClientRect();L.$16k={x:Q.clientX-W.left,y:Q.clientY-W.top},L.$5k()}},L.setComponent(Z)},y("RulerFrame",n,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(b){var Q=this,D=Q._component,o=Q.getView();if(o){if(Q._component=b,Q.fp("component",D,b),D){var E=Q.getComponentView(D);j(o,E),R(o,"mousemove",Q.$15k),Q.removeComponentPropertyChangeListener(D,Q.$14k)}if(b){var W=Q.getComponentView(b);c(o,W),S(W,C,u),v(o,"mousemove",Q.$15k),Q.addComponentPropertyChangeListener(b,Q.$14k)}}},addComponentPropertyChangeListener:function(r,F){r&&r.mp&&r.mp(F)},removeComponentPropertyChangeListener:function(N,q){N&&N.ump&&N.ump(q)},getComponentHZoom:function(B){return B&&B.getZoom?B.getZoom():1},getComponentVZoom:function(y){return y&&y.getZoom?y.getZoom():1},getComponentViewRect:function(y){return y&&y.getViewRect?y.getViewRect():void 0},getComponentView:function(V){return V&&V.getView?V.getView():V},invalidateComponent:function(K){K&&K.iv&&K.iv()},validateComponent:function(g){g&&g.validate&&g.validate()},$7k:function(y,g,L,I,s,f,e,D,l,H,K,$){if(g.visible){var p=this._defaultRulerConfig,r="borderStyle",t="borderColor",a="borderWidth",C="background",G=g[r]||p[r],O=g[t]||p[t],N=g[a]||p[a],v=g.size!=k?g.size:p.size,Q=g[C]||p[C],U=v+N,u=this.$6k(N,G,O,y,L,s,U,e,D,l,H,K,$);S(y,s,"0px"),f?J.setCanvas(y,I-u,v):J.setCanvas(y,v,I-u),S(y,"background",Q),S(y,T,A)}else S(y,T,Y),S(this.getComponentView(this._component),s,"0px")},$6k:function(H,p,I,W,M,V,L,A,K,l,t,F,h){var z=0;return S(W,M,H+"px "+p+" "+I),S(this.getComponentView(this._component),V,L+a),A?(S(W,K,l+a),z+=l):S(W,K,"0px"),t?(S(W,F,h+a),z+=h):S(W,F,"0px"),z},validateImpl:function(){var O=this,q=O._component,r=O.$1k,u=O.$2k,v=O.$3k,D=O.$4k,g=O._view,y=O._defaultRulerConfig,X=O._topRulerConfig,T=O._rightRulerConfig,s=O._bottomRulerConfig,W=O._leftRulerConfig,I=y.size;if(g&&q){var d=X.size!=k?X.size:I,E=T.size!=k?T.size:I,R=s.size!=k?s.size:I,p=W.size!=k?W.size:I;O.$7k(r,X,"border-bottom",g.offsetWidth,B,!0,W.visible,H,p,T.visible,l,E),O.$7k(u,T,"border-left",g.offsetHeight,l,!1,X.visible,B,d,s.visible,x,R),O.$7k(v,s,"border-top",g.offsetWidth,x,!0,W.visible,H,p,T.visible,l,E),O.$7k(D,W,"border-right",g.offsetHeight,H,!1,X.visible,B,d,s.visible,x,R),O.$13k?delete O.$13k:O.invalidateComponent(q),O.validateComponent(q),O.$5k()}},$5k:function(){function x(q,N,Y,b,x,J){if(N.visible){var j=I(q),B=N[O]||C,l=N[u]!=k?N[u]:p,T=N[z]||a,E=N[R]||X,y=N.size!=k?N.size:Z,wh=N[s]||V,qr=N[t]||h,Io=N[M]||m,wq=N[c]!=k?N[c]:$,Gm=N[L]!=k?N[L]:_,Wh=N[H]!=k?N[H]:F,tm=N[f]!=k?N[f]:i,sc=N[w]!=k?N[w]:W,fp=N[P]!=k?N[P]:d,lp=N[n]||Hm,ji=N[e]||Ip;l&&(B=v[J]=v.$8k(v[J]||B,N[D]||U,N[A]||g,b?o:K,qr)),Y.call(v,j,r,S,Q,G,y,b?o:K,B,T,E,x,wh,Io);var Tq=v.$16k;(wq||Gm)&&Tq&&(b?v.$9k(j,Tq.x,y,lp,ji,wq,Gm,Wh,tm,sc,fp):v.$10k(j,Tq.y,y,lp,ji,wq,Gm,Wh,tm,sc,fp,x))}}var v=this,B=v.$1k,Y=v.$2k,q=v.$3k,j=v.$4k,E=v._topRulerConfig,T=v._rightRulerConfig,N=v._bottomRulerConfig,y=v._leftRulerConfig,l=v._defaultRulerConfig,J=v._component,b=v.getComponentViewRect(J),o=v.getComponentHZoom(J),K=v.getComponentVZoom(J),r=b.x*o,Q=r+b.width*o,S=b.y*K,G=S+b.height*K,Z=v._defaultRulerConfig.size,O="defaultMajorTickSpacing",D="maxPhysicalMajorTickSpacing",A="minPhysicalMajorTickSpacing",u="tickSpacingAdaptable",z="majorTickTextFont",R="majorTickTextColor",s="majorTickColor",M="minorTickColor",c="guideVisible",L="guideTipVisible",H="guideTipBorderColor",f="guideTipTextColor",w="guideTipTextFont",P="guideTipBackground",n="guideColor",e="guideWidth",t="minMajorTickSpacing",C=l[O],U=l[D],g=l[A],p=l[u],a=l[z],X=l[R],V=l[s],h=l[t],m=l[M],$=l[c],_=l[L],F=l[H],i=l[f],W=l[w],d=l[P],Hm=l[n],Ip=l[e];v._view&&J&&(x(B,E,v.$11k,!0,!1,"_currentTopMajorTickSpacing"),x(Y,T,v.$12k,!1,!0,"_currentRightMajorTickSpacing"),x(q,N,v.$11k,!0,!0,"_currentBottomMajorTickSpacing"),x(j,y,v.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(I,z,T,e,B){return T>I*e?I=p(z/e/B)*B:I*e>z&&(I=h(T/e/B)*B),I},getHTipText:function(T){var b=this,f=b._component,A=0,m=b._view.getBoundingClientRect();return f.lp?A=Q(f.lp({x:T.x+m.left,y:T.y}).x):A-=Q(this.getComponentView(f).style.left)||0,A},$9k:function(u,z,f,F,y,L,h,s,m,_,o){var H=this,M=H._component;u.save(),J.translateAndScale(u,0,0,1);var P=z-(Q(this.getComponentView(M).style.left)||0),S=0;if(z=H.getHTipText(H.$16k),L&&(u.beginPath(),u.fillStyle=F,u.rect(P,S,y,f),u.fill()),h){u.beginPath(),u.textAlign="center",u.textBaseline="middle",u.font=_;var r=u.measureText(z).width+6;u.fillStyle=o,u.rect(P-r/2,S,r,f),u.fill(),u.strokeStyle=s,u.stroke(),u.beginPath(),u.fillStyle=m,u.fillText(z,P,S+f/2)}u.restore()},getVTipText:function(m){var _=this,Y=_._component,L=0,w=_._view.getBoundingClientRect();return Y.lp?L=Q(Y.lp({x:m.x,y:m.y+w.top}).y):L-=Q(this.getComponentView(Y).style.top)||0,L},formatScaleText:function(b){return Math.round(b)},$10k:function(o,L,U,u,G,i,v,k,l,y,$,d){var f=this,H=f._component;o.save(),J.translateAndScale(o,0,0,1);var Z=U/2,I=L-(Q(this.getComponentView(H).style.top)||0);if(L=f.getVTipText(f.$16k),i&&(o.beginPath(),o.fillStyle=u,o.rect(Z-U/2,I,U,G),o.fill()),v){o.translate(Z,I),o.rotate((d?90:-90)*m/180),o.translate(-Z,-I),o.beginPath(),o.textAlign="center",o.textBaseline="middle",o.font=y;var K=o.measureText(L).width+6;o.fillStyle=$,o.rect(Z-K/2,I-U/2,K,U),o.fill(),o.strokeStyle=k,o.stroke(),o.fillStyle=l,o.fillText(L,Z,I)}o.restore()},$11k:function(M,f,E,F,v,W,w,T,j,A,V,$,k){M.save(),E=0;var I=f,L=F,N=(I+L)/2;f=0,F=L-I,J.translateAndScale(M,0,0,1);var y=0,b=0,Y=Q(W/2),C=W-Y,e=V?0:Y,c=T*w,R=c/10;f-=c,F+=c,M.clearRect(f,0,F-f,W),M.beginPath(),M.fillStyle=k;var t=p(N/R)*R-I;for(y=t;F>y;y+=R)M.rect(y,E+e,1,C);for(y=t;y>f;y-=R)M.rect(y,E+e,1,C);for(M.fill(),e=V?0:1,M.beginPath(),M.fillStyle=$,t=p(N/c)*c-I,y=t;F>y;y+=c)M.rect(y,E+e,1,W-1);for(y=t;y>f;y-=c)M.rect(y,E+e,1,W-1);M.fill();var B=Q(/\d+px/.exec(j)[0]),g=(B||10)/2;M.textBaseline="middle",e=V?W-g-2:g+2,M.beginPath(),M.fillStyle=A,M.font=j;var m=p(N/c)*c/w;for(y=t,b=m;F>y;y+=c,b+=T){var x=this.getHScaleText?this.getHScaleText(y):b;M.fillText(this.formatScaleText(x),y+2,E+e)}for(y=t,b=m;y>f;y-=c,b-=T){var x=this.getHScaleText?this.getHScaleText(y):b;M.fillText(this.formatScaleText(x),y+2,E+e)}M.restore()},$12k:function(u,s,e,X,f,_,n,Z,r,b,K,l,T){function A(f,U,y,x,h,N){h=v.getVScaleText?v.getVScaleText(y):h,h=v.formatScaleText(h),u.translate(f+U,y),u.rotate(-x),u.translate(-f-U,-y),u.fillText(h,f+U+(N?2:1),y),u.translate(f+U,y),u.rotate(x),u.translate(-f-U,-y)}u.save(),s=0;var B=e,U=f,i=(B+U)/2;e=0,f=U-B,J.translateAndScale(u,0,0,1);var g=0,v=this,$=0,P=Q(_/2),z=_-P,M=K?0:P,O=Z*n,Y=O/10;e-=O,f+=O,u.clearRect(s,0,_,f-e),u.beginPath(),u.fillStyle=T;var E=p(i/Y)*Y-B;for(g=E;f>g;g+=Y)u.rect(s+M,g,z,1);for(g=E;g>e;g-=Y)u.rect(s+M,g,z,1);for(u.fill(),M=K?0:1,u.beginPath(),u.fillStyle=l,E=p(i/O)*O-B,g=E;f>g;g+=O)u.rect(s+M,g,_-1,1);for(g=E;g>e;g-=O)u.rect(s+M,g,_-1,1);u.fill();var j=Q(/\d+px/.exec(r)[0]),y=(j||10)/2,h=90*m/180;u.textBaseline="middle",M=K?_-y:y+2,h=K?-h:h,u.beginPath(),u.fillStyle=b,u.font=r;var D=p(i/O)*O/n;for(g=E,$=D;f>g;g+=O,$+=Z)A(s,M,g,h,$,K);for(g=E,$=D;g>e;g-=O,$-=Z)A(s,M,g,h,$,K);u.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var B=this,f=B._component,K=B._view;f&&B.removeComponentPropertyChangeListener(f,B.$14k),K&&(R(K,"mousemove",B.$15k),j(K.parentNode,K),B._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);