!function(D,z,U){"use strict";var L="ht",l=D[L],T=l.Default,k=l.graph,P=T.getInternal(),f=P.ui(),m=f.NodeUI.prototype,Z=f.ShapeUI.prototype,B=k.GraphView,X=B.prototype,c=f.EdgeUI.prototype,t=l.Node,x=l.Shape,u=l.Edge,q=l.Group,n=T.isTouchable,I=T.preventDefault,v=D.setTimeout,Y=T.grow,Q=T.isDragging,h=T.getDistance,R=null,j=l.List,K="undefined"!=typeof Float32Array?Float32Array:Array,b=Math,E=b.PI,i="Crossing",A="No Crossing",d=E/2,a=2*E,S=b.atan2,J=b.sqrt,O=b.pow,N=b.sin,w=b.cos,$=b.min,o=b.max,F=b.abs,G=b.ceil,r=b.round,V=T.unionPoint,H=T.unionRect,g=T.containsPoint,p=T.clone,M="rgb(52, 152, 219)",_="red",s={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},y={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var K=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],h=0;h<K.length;h++){var q=K[h];q=0===h%2?q/400*y.width:q/100*y.height,K[h]=q}return y.width>120&&(K[4]=y.width-26,K[6]=y.width-40,K[10]=y.width-40,K[12]=y.width-26,K[18]=33),K}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},e={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:M,rotation:.61},{type:"circle",rect:[200,120,70,70],background:M,rotation:.61},{type:"circle",rect:[200,220,70,70],background:M,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:M},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:M}]},C={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:_,rotation:.61}]},W={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:M},{type:"circle",rect:[0,210,90,90],background:M},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:M}]},qk={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:_},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:_}]},Ic={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:M}]},hg={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:_}]},zb={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Vm={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Ff=function(Y){var B=Y.touches[0];return B?B:Y.changedTouches[0]},Jp=function(I,L,w,s){return S(s-L,w-I)},ur=function(f,E){return{x:f.x*E,y:f.y*E}},dn=function(b,Z){b.each(function(C){return b.isSelected(C)?Z(C):void 0})},ys=function(c,U){c.reverseEach(function(u){return c.isSelected(u)?U(u):void 0})},Pq=function(L,m,R){var e,H,X,v,G,D=this,Z=m,S=D.gv;if(L instanceof x){X=L.getSegments();var C=S.getDataUI(L);G=C._55O.$15l,X&&X.size()||(X=He(G)),L.isClosePath()&&X.indexOf(5)<0&&(X=new j(X._as),X.add(5)),e=dm(L,C,Z),H=G[e]}else{var o=S.getDataUI(L);G=lp(o,L.s("edge.points")),X=L.s("edge.segments"),X&&X.size()||(X=He(G)),G=G._as,e=dm(L,o,Z),H=G[e]}if(X&&(v=X.get(Z)),2===v||1===v||5===v){var i=G[e+1];5===v&&(i=G[0]);var l=hd(H,R,i);return l}return R},Gf=function(D,C,S,E){var r=C/2,Q=S/2,k=Sb(D,-r,-Q,E),e=Sb(D,r,-Q,E),U=Sb(D,-r,Q,E),K=Sb(D,r,Q,E),u=Sb(D,0,-Q,E),M=Sb(D,r,0,E),F=Sb(D,0,Q,E),B=Sb(D,-r,0,E);return[k,e,U,K,u,M,F,B]},hd=function(o,h,X){var G={x:h.x-o.x,y:h.y-o.y},g={x:X.x-o.x,y:X.y-o.y},H=J(O(X.x-o.x,2)+O(X.y-o.y,2)),s={x:g.x/H,y:g.y/H},M=G.x*s.x+G.y*s.y,z={x:s.x*M,y:s.y*M};return{x:o.x+z.x,y:o.y+z.y}},Sb=function(C,r,e,g){var s=w(g)*r-N(g)*e,j=N(g)*r+w(g)*e;return C?{x:C.x+s,y:C.y+j}:{x:s,y:j}},td=function(d,T){return T>2*d?d:T/2},um=function(E,C,P,b){var A=h(E,C);return P=b?$(P,A):td(P,A),A?P/=A:P=0,{x:E.x+(C.x-E.x)*P,y:E.y+(C.y-E.y)*P}},vr=function($,i){var W,H,R=$.gv,V=$._data,m=V._40I,g=V._41I,z=V.s("edge.offset"),e=V.s("edge.source.position"),p=V.s("edge.target.position"),Q=V.s("edge.source.offset.x"),u=V.s("edge.source.offset.y"),_=V.s("edge.target.offset.x"),d=V.s("edge.target.offset.y"),S=V.s("edge.source.anchor.x"),A=V.s("edge.source.anchor.y"),G=V.s("edge.target.anchor.x"),t=V.s("edge.target.anchor.y");if(i?(W=P.getEdgeAgentPosition(R,m,e,Q,u,S,A),H=P.getEdgeAgentPosition(R,g,p,_,d,G,t)):(W=P.getEdgeAgentPosition(R,m,e,0,0,S,A),H=P.getEdgeAgentPosition(R,g,p,0,0,G,t)),"points"===V.s("edge.type")&&z&&!V.s("edge.center")&&W){var B=V.s("edge.points")||new j,I=B.size(),c=um(W,I?B.get(0):H,z,I),U=um(H,I?B.get(I-1):W,z,I);W=c,H=U}return[W,H]},lp=function(h,B,N){var K=h._78o,O=h._data,u=O.s("edge.type"),y=[K.sourcePoint,K.targetPoint];return"points"===u?N&&(y=vr(h)):y=K.center?u?N?vr(h):vr(h,!0):N?vr(h):[K.c1,K.c2]:N?vr(h):vr(h,!0),B=new j(B?B._as:R),B.add(y[0],0),B.add(y[1]),B},vb=function(y){return y=new j(y._as),y.removeAt(0),y.removeAt(y.size()-1),y},He=function(r){r._as||(r=new j(r));var b=new j;b.add(1);for(var m=1;m<r.size();m++)b.add(2);return b},af=function($,b){return{x:($.x+b.x)/2,y:($.y+b.y)/2}},Tp=function(u,s){return{x:u.x+1*(s.x-u.x)/4,y:u.y+1*(s.y-u.y)/4}},ie=function(Z,u){return{x:Z.x+3*(u.x-Z.x)/4,y:Z.y+3*(u.y-Z.y)/4}},rl=function(G,I,V,i){var O=I.x+I.width/2,R=I.y+I.height/2,E=J(O*O+R*R),D=S(R,O)+V;return{x:i.x+E*w(D),y:i.y+E*N(D)}},Zf=X.validateImpl,Oj=X.isRectEditable,Bq=X.isPointEditable,Og=X._42,Fd=Z._79o,Af=c._79o,ym=Z._48O,Gb=Z._47O,Vi=m._48O,gq=m._80o,Yp=Z._80o,mi=m.getSelectWidth,hq=m._47O,Dg=c._47O,Pd=X.isEditable,Zl=["northwest","north","northeast","east","southeast","south","southwest","west"],uf=function(B,A,c,h,w,m,y,k,t,i){var x=B.x,Q=B.y,n=B.width,z=B.height,q={x:x+n/2,y:Q+z/2};h=h||0,A=Sb(q,A.x-q.x,A.y-q.y,-h),y&&!k&&(A.x+=t,A.y+=i);var d=.01;if("northwest"===c?(A.x+w>x+n-d&&(A.x=x+n-w-d),A.y+w>Q+z-d&&(A.y=Q+z-w-d),B=V(A,{x:x+n,y:Q+z})):"north"===c?(A.y+w>Q+z-d&&(A.y=Q+z-w-d),B=V({x:x,y:A.y},{x:x+n,y:Q+z})):"northeast"===c?(A.x<x+w+d&&(A.x=x+w+d),A.y+w>Q+z-d&&(A.y=Q+z-w-d),B=V({x:x,y:A.y},{x:A.x,y:Q+z})):"west"===c?(A.x+w>x+n-d&&(A.x=x+n-w-d),B=V({x:A.x,y:Q},{x:x+n,y:Q+z})):"east"===c?(A.x<x+w+d&&(A.x=x+w+d),B=V({x:x,y:Q},{x:A.x,y:Q+z})):"southwest"===c?(A.x+w>x+n-d&&(A.x=x+n-w-d),A.y<Q+w+d&&(A.y=Q+w+d),B=V({x:A.x,y:Q},{x:x+n,y:A.y})):"south"===c?(A.y<Q+w+d&&(A.y=Q+w+d),B=V({x:x,y:Q},{x:x+n,y:A.y})):"southeast"===c&&(A.x<x+w+d&&(A.x=x+w+d),A.y<Q+w+d&&(A.y=Q+w+d),B=V({x:x,y:Q},A)),"keepRatio"===m&&(!y&&k||y&&!k)&&("northeast"===c||"southeast"===c||"northwest"===c||"southwest"===c)){var f=B.width,U=B.height,X=f/n,r=U/z,C=$(X,r);B.width=n*C,B.height=z*C,"northeast"===c?B.y=Q+(z-B.height):"northwest"===c?(B.y=Q+(z-B.height),B.x=x+(n-B.width)):"southwest"===c&&(B.x=x+(n-B.width))}B.x-=q.x,B.y-=q.y;var K=rl(R,B,h,q);return B.x=K.x-B.width/2,B.y=K.y-B.height/2,B},cr=function(w,A,h,P){var $=w.getRotation(),j=A,e=j.x,K=j.y,t=j.width,D=j.height,C={x:e+j.width/2,y:K+j.height/2};P=Sb(C,P.x-C.x,P.y-C.y,-$),"northwest"===h?j=V(P,{x:e+t,y:K+D}):"north"===h?j=V({x:e,y:P.y},{x:e+t,y:K+D}):"northeast"===h?j=V({x:e,y:P.y},{x:P.x,y:K+D}):"west"===h?j=V({x:P.x,y:K},{x:e+t,y:K+D}):"east"===h?j=V({x:e,y:K},{x:P.x,y:K+D}):"southwest"===h?j=V({x:P.x,y:K},{x:e+t,y:P.y}):"south"===h?j=V({x:e,y:K},{x:e+t,y:P.y}):"southeast"===h&&(j=V({x:e,y:K},P)),w.setRect(j),j.x-=C.x,j.y-=C.y;var R=rl(w,j,$,C);w.p(R.x,R.y)},Bb=function(L,E,j,x,_,f,v,V){var e=R;f?(e=Sb(R,_.x-E.x,_.y-E.y,-j),e.x-=v.x,e.y-=v.y):e=Sb(R,_.x-E.x,_.y-E.y,0);var B={x:E.x+e.x,y:E.y+e.y};V&&(B=V(B.x,B.y)),B.e=L.getPoints().get(x).e,L.setPoint(x,B);var X=L.getWidth(),q=L.getHeight(),S=L.p().x-X/2,F=L.p().y-q/2;S-=E.x,F-=E.y;var y=rl(L,{x:S,y:F,width:X,height:q},j,E);L.p(y.x,y.y)},dm=function(R,o,p){var E,P;if(R instanceof x?(E=R.getPoints(),P=R.getSegments()):R instanceof u&&"points"===R.s("edge.type")&&(E=R.s("edge.points"),P=R.s("edge.segments"),E=lp(o,E)),P&&P.size()||(P=He(E)),R instanceof x&&R.isClosePath()&&P.indexOf(5)<0&&(P=new j(P._as),P.add(5)),P)for(var J=-1,U=0;U<P.size();U++){if(U===p)return J;var I=P.get(U);1===I?J+=1:2===I?J+=1:3===I?J+=2:4===I&&(J+=3)}},yj=function(Q,P,s){var R,W;if(Q instanceof x?(R=Q.getPoints(),W=Q.getSegments()):Q instanceof u&&"points"===Q.s("edge.type")&&(R=Q.s("edge.points"),W=Q.s("edge.segments"),R=lp(P,R)),W&&W.size()||(W=He(R)),W)for(var O=-1,h=0;h<W.size();h++){var D=W.get(h);if(1===D?O+=1:2===D?O+=1:3===D?O+=2:4===D&&(O+=3),O===s)return h}},zl=function(w,E){var I=[w[0]-E[0],w[1]-E[1],w[2]-E[2]];return I},Mc=function(){var I=new K(16);return I[0]=1,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=1,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=1,I[11]=0,I[12]=0,I[13]=0,I[14]=0,I[15]=1,I},Li=function(u,W){var I=u[0],Z=u[1],O=u[2];return u[0]=W[0]*I+W[4]*Z+W[8]*O+W[12],u[1]=W[1]*I+W[5]*Z+W[9]*O+W[13],u[2]=W[2]*I+W[6]*Z+W[10]*O+W[14],u},gr=function(o,P){if(P){var X=N(P),B=w(P),A=o[0],U=o[1],G=o[2],K=o[3],c=o[8],M=o[9],k=o[10],q=o[11];o[0]=A*B-c*X,o[1]=U*B-M*X,o[2]=G*B-k*X,o[3]=K*B-q*X,o[8]=A*X+c*B,o[9]=U*X+M*B,o[10]=G*X+k*B,o[11]=K*X+q*B}},eh=function(v,W){for(var q=v.s("grid.row.count"),H=v.s("grid.column.count"),N=0;q>N;N++)for(var Y=0;H>Y;Y++){var B=v.getCellRect(N,Y);if(g(B,W))return{rowIndex:N,columnIndex:Y,rect:B,grid:v}}return null},Gm=function(k,U,F,x,J,W){var E={},o=F-k,A=x-U,v=b.sqrt(o*o+A*A),Q=o/v,V=A/v,y=(-k+J)*Q+(-U+W)*V;return 0>=y?(E.x=k,E.y=U):y>=v?(E.x=F,E.y=x):(E.x=k+y*Q,E.y=U+y*V),o=J-E.x,A=W-E.y,E.z=b.sqrt(o*o+A*A),E},Hq=function(d,t){var b,Y,l,I,q,v,E,U,B=d.getPoints(),z=d.getSegments(),S=d.p(),r=d.getRotation();if(!z||!(z.indexOf(3)>0||z.indexOf(4)>0)){for(U=0;U<=B.size()-1;U++)if(U===B.size()-1?(q=B.get(0),I=B.get(U)):(I=B.get(U),q=B.get(U+1)),I=Sb(S,I.x-S.x,I.y-S.y,r),q=Sb(S,q.x-S.x,q.y-S.y,r),v=Gm(I.x,I.y,q.x,q.y,t.x,t.y),E=v.z,E<(d.s("shape.border.width")||10)){Y=I,l=q,b=U;break}if(b!=R){var N=Gm(Y.x,Y.y,l.x,l.y,t.x,t.y),n=h(Y,N);return{attachIndex:b,attachOffset:n}}}},Hm=function(I){for(var O=I._data,n=O.p(),M=O.getRotation(),r=O.getPoints(),D=R,s=[],p=0;p<r.size();p++)D=r.get(p),s.push(Sb(n,D.x-n.x,D.y-n.y,M));I._55O.$15l=s};T.setImage("xeditinteractor_parentIcon",e),T.setImage("xeditinteractor_hostIcon",C),T.setImage("xeditinteractor_edgeIcon",W),T.setImage("xeditinteractor_removeIcon",qk),T.setImage("xeditinteractor_sourceIcon",Ic),T.setImage("xeditinteractor_targetIcon",hg),T.setImage("xeditinteractor_elevationIcon",zb),T.setImage("xeditinteractor_tallIcon",Vm),X._editPointSize=n?24:9,X._edgeHelpers=["parent","remove","source","target"],X._leftTopHelpers=["parent"],X._rightTopHelpers=["host"],X._leftBottomHelpers=["edge"],X._rightBottomHelpers=["remove"],Zl=Zl.concat(Zl).concat(Zl),c._79o=function(){var J=this,w=J.gv,e=w.getZoom(),Z=w._editInteractor,_=Af.call(J);if(!_)return null;var L=vr(J,!0),f=L[0],s=L[1],c={x:_.x,y:_.y,width:_.width,height:_.height},D=V(f,s);if(Z instanceof k.XEditInteractor){c=H(c,D);var p=J._55O,d=w.getEditPointSize()/e+2,B=0;p&&p._43O&&(B+=d/2,Y(c,B))}return c},c._47O=function(E){var m=this,S=m.gv,i=S._editInteractor;i instanceof k.XEditInteractor||Dg.call(m,E)},c.rectIntersects=function(u){var x=this,p=x._data,N=x.gv,E=N.getZoom(),s=x._55O,g=N._editInteractor;if(g instanceof k.XEditInteractor&&N.isEditable(p)&&s&&s._43O&&"points"===p.s("edge.type")){var A=p.s("edge.points"),K=p.s("edge.segments");A=lp(x,A),K&&K.size()||(K=He(A)),A=A._as;var f=!1,B=n?5:1,C=u.x+B,h=u.y+B,H={x:C,y:h};if(g._edge===p&&g._hoverSegmentIndex>=0){var F=N._editInteractor._hoverSegmentIndex,y=K.get(F),O=dm(p,x,F),Q=R;if(O!=R&&O>=0){var w=A[O],D=N.getSegmentHoverWidth()/E;if(2===y||1===y){var W=A[O+1];Q=bg(new cs(w.x,w.y),new cs(W.x,W.y),new cs(H.x-D,H.y-D),new cs(H.x+2*D,H.y+2*D)),Q.$62l===i&&(f=!0)}else if(3===y){var j=A[O+1],W=A[O+2];Q=Zo(new cs(w.x,w.y),new cs(j.x,j.y),new cs(W.x,W.y),new cs(H.x-D,H.y-D),new cs(H.x+2*D,H.y+2*D)),Q.$62l===i&&(f=!0)}else if(4===y){var $=A[O+1],V=A[O+2];W=A[O+3],Q=Bn(new cs(w.x,w.y),new cs($.x,$.y),new cs(V.x,V.y),new cs(W.x,W.y),new cs(H.x-D,H.y-D),new cs(H.x+2*D,H.y+2*D)),Q.$62l===i&&(f=!0)}}}if(f)return!0}return R},Z._47O=function(x){var K=this,t=K.gv,O=t._editInteractor;O instanceof k.XEditInteractor||Gb.call(K,x)},Z.rectIntersects=function(u){var e=this,O=e._data,o=e.gv,j=o.getZoom(),N=e._55O,Y=o._editInteractor;if(Y instanceof k.XEditInteractor&&o.isEditable(O)&&N&&N._43O){var h=N.$15l,F=!1,K=n?5:1,B=u.x+K,w=u.y+K,a={x:B,y:w};if(h&&h.length===O.getPoints().size()||(Hm(e),h=N.$15l),Y._shape===O&&Y._hoverSegmentIndex>=0){var M=O.getSegments();M&&M.size()||(M=He(h));var s=o._editInteractor._hoverSegmentIndex,L=M.get(s),P=dm(O,e,s),v=R;if(P!=R&&P>=0){var U=h[P],H=o.getSegmentHoverWidth()/j;if(2===L||1===L){var I=h[P+1];v=bg(new cs(U.x,U.y),new cs(I.x,I.y),new cs(a.x-H,a.y-H),new cs(a.x+2*H,a.y+2*H)),v.$62l===i&&(F=!0)}else if(3===L){var T=h[P+1],I=h[P+2];v=Zo(new cs(U.x,U.y),new cs(T.x,T.y),new cs(I.x,I.y),new cs(a.x-H,a.y-H),new cs(a.x+2*H,a.y+2*H)),v.$62l===i&&(F=!0)}else if(4===L){var $=h[P+1],Q=h[P+2];I=h[P+3],v=Bn(new cs(U.x,U.y),new cs($.x,$.y),new cs(Q.x,Q.y),new cs(I.x,I.y),new cs(a.x-H,a.y-H),new cs(a.x+2*H,a.y+2*H)),v.$62l===i&&(F=!0)}}}if(F)return!0}return R},Z._48O=function(){var L=this,R=L.gv,n=R._editInteractor;n instanceof k.XEditInteractor?(m._48O.call(L),L._55O._43O&&Hm(L)):ym.call(L)},Z._79o=function(){var Z=this,s=Z.gv,t=s.getZoom(),j=s._editInteractor,n=Fd.call(Z);if(n){var g={x:n.x,y:n.y,width:n.width,height:n.height};if(j instanceof k.XEditInteractor){var _=Z._55O,X=s.getEditPointSize()/t+2,H=0;_&&_._43O&&(H+=X/2,Y(g,H))}return g}},m._47O=function(w){var e=this,B=e.gv,g=B._editInteractor;if(g instanceof k.XEditInteractor);else{var N=e._55O;N&&N._98o&&hq.call(e,w)}},m.getSelectWidth=function(){var O=this,L=O.gv,R=L._editInteractor,Q=O._data;return L.isEditable(Q)&&R instanceof k.XEditInteractor?0:mi.call(O)},m._80o=function(U){var u=this,$=u.gv._editInteractor;if(gq.call(u,U),$&&$._debug){U.save(),U.beginPath(),U.lineWidth=1,U.strokeStyle="green";var L=u._79o();L&&(U.rect(L.x,L.y,L.width,L.height),U.stroke()),U.restore()}},Z._80o=function(J){var z=this,u=z.gv._editInteractor;if(Yp.call(z,J),u&&u._debug){J.save(),J.beginPath(),J.lineWidth=1,J.strokeStyle="green";var C=z._79o();J.rect(C.x,C.y,C.width,C.height),J.stroke(),J.restore()}},m._48O=function(){var L=this,G=L.gv,A=L._data,v=G._editInteractor,S=L._55O,V=A.p(),O=A.getRotation();if(v instanceof k.XEditInteractor){if(S._42O){var o=Gf(V,A.getWidth(),A.getHeight(),O),p=o[0],t=o[1],u=o[2],j=o[3],H=o[4],l=o[5],f=o[6],X=o[7];S.$45l=[p,H,t,l,j,f,u,X]}}else Vi.call(L)},X.getResizeMode=function(){return this.$25l||"normal"},X.setResizeMode=function(P){var w=this.$25l;this.$25l=P,this.fp("resizeMode",w,P)},X.getSnapAngle=function(){return this.$26l||Math.PI/36},X.setSnapAngle=function(O){var r=this.$26l;this.$26l=O,this.fp("snapAngle",r,O)},X.getSnapSpacing=function(){return this.$27l},X.setSnapSpacing=function(W){var j=this.$27l;this.$27l=W,this.fp("snapSpacing",j,W)},X.getPointSnapSpacing=function(){return this._pointSnapSpacing},X.setPointSnapSpacing=function(N){var a=this._pointSnapSpacing;this._pointSnapSpacing=N,this.fp("pointSnapSpacing",a,N)},X.setHelperEditableFunc=function(w){var l=this._helperEditableFunc;this._helperEditableFunc=w,this.fp("helperEditableFunc",l,w)},X.getHelperEditableFunc=function(){return this._helperEditableFunc},X.setLeftTopHelpers=function(H){var U=this._leftTopHelpers;this._leftTopHelpers=H,this.fp("leftTopHelpers",U,H)},X.getLeftTopHelpers=function(){return this._leftTopHelpers},X.setLeftTopHelpersAlign=function(T){var G=this._leftTopHelpersAlign;this._leftTopHelpersAlign=T,this.fp("leftTopHelpersAlign",G,T)},X.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},X.setRightTopHelpers=function(q){var w=this._rightTopHelpers;this._rightTopHelpers=q,this.fp("rightTopHelpers",w,q)},X.getRightTopHelpers=function(){return this._rightTopHelpers},X.setRightTopHelpersAlign=function(_){var Z=this._rightTopHelpersAlign;this._rightTopHelpersAlign=_,this.fp("rightTopHelpersAlign",Z,_)},X.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},X.setLeftBottomHelpers=function(g){var Y=this._leftBottomHelpers;this._leftBottomHelpers=g,this.fp("leftBottomHelpers",Y,g)},X.getLeftBottomHelpers=function(){return this._leftBottomHelpers},X.setLeftBottomHelpersAlign=function(Y){var M=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=Y,this.fp("leftBottomHelpersAlign",M,Y)},X.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},X.setRightBottomHelpers=function(d){var r=this._rightBottomHelpers;this._rightBottomHelpers=d,this.fp("rightBottomHelpers",r,d)},X.getRightBottomHelpers=function(){return this._rightBottomHelpers},X.setRightBottomHelpersAlign=function(c){var x=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=c,this.fp("rightBottomHelpersAlign",x,c)},X.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},X.setEdgeHelpers=function(x){var R=this._edgeHelpers;this._edgeHelpers=x,this.fp("edgeHelpers",R,x)},X.getEdgeHelpers=function(){return this._edgeHelpers},X.isHelperEditable=function(k,s){return k instanceof u&&("host"===s||"edge"===s||"elevation"===s||"tall"===s)?!1:k instanceof t&&("source"===s||"target"===s)?!1:"pointElevation"===s?this._helperEditableFunc?this._helperEditableFunc(k,s):!1:this._helperEditableFunc?this._helperEditableFunc(k,s):!0},X.getEditHelperSize=function(){return this._editHelperSize||(n?28:16)},X.setEditHelperSize=function(G){var M=this._editHelperSize;this._editHelperSize=G,this.fp("editHelperSize",M,G)},X.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},X.setEditRectBorderColor=function(V){var A=this.$28l;this.$28l=V,this.fp("editRectBorderColor",A,V)},X.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},X.setNodeBorderColor=function(K){var e=this.$29l;this.$29l=K,this.fp("nodeBorderColor",e,K)},X.getEditRectBorderStyle=function(){return this.$30l||"dashed"},X.setEditRectBorderStyle=function(l){var V=this.$30l;this.$30l=l,this.fp("editRectBorderStyle",V,l)},X.getControlPointBackground=function(){return this.$31l||"#ff0"},X.setControlPointBackground=function(g){var x=this.$31l;this.$31l=g,this.fp("controlPointBackground",x,g)},X.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},X.setControlPointBorderColor=function(u){var n=this.$32l;this.$32l=u,this.fp("controlPointBorderColor",n,u)},X.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},X.setJoinPointBackground=function(r){var y=this.$33l;this.$33l=r,this.fp("joinPointBackground",y,r)},X.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},X.setJoinPointBorderColor=function(g){var d=this.$34l;this.$34l=g,this.fp("joinPointBorderColor",d,g)},X.getDirectionLineColor=function(){return this.$35l||"#888"},X.setDirectionLineColor=function(j){var T=this.$35l;this.$35l=j,this.fp("directionLineColor",T,j)},X.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},X.setSegmentHoverColor=function(V){var y=this.$36l;this.$36l=V,this.fp("segmentHoverColor",y,V)},X.getSegmentHoverWidth=function(){return this.$22l||(n?16:8)},X.setSegmentHoverWidth=function(a){var G=this.$22l;this.$22l=a,this.fp("segmentHoverWidth",G,a)},X.getSnapPointBorderColor=function(){return this.$38l||"#f00"},X.setSnapPointBorderColor=function(Q){var f=this.$38l;this.$38l=Q,this.fp("snapPointBorderColor",f,Q)},X.getEditRectPadding=function(){return this.$39l!=R?this.$39l:6},X.setEditRectPadding=function(V){var E=this.$39l;this.$39l=V,this.fp("editRectPading",E,V)},X.isRectEditable=function(b){var g=this,u=g._editInteractor;return u instanceof k.XEditInteractor?g._rectEditableFunc?g._rectEditableFunc(b):!0:Oj.call(g,b)},X.isPointEditable=function(t){var M=this,Y=M._editInteractor;return Y instanceof k.XEditInteractor?M._pointEditableFunc?M._pointEditableFunc(t):!0:Bq.call(M,t)},X.validateImpl=function(){var y=this,H=y.$14l,j=y._editInteractor;if(H){var s=y.getWidth(),n=y.getHeight();(s!==H.clientWidth||n!==H.clientHeight)&&(j&&(j._68I=1),P.setCanvas(H,s,n),y._32I=1)}Zf.call(this)},X.isEditable=function(p){var A=Pd.call(this,p),s=this._editInteractor;if(s instanceof k.XEditInteractor&&p instanceof u){if(!p.s("2d.editable"))return!1;var S=this.getEditableFunc();A=S?S(p):!0}return A},X._42=function(K,B){var c=this,M=c._editInteractor;Og.call(c,K,B),M instanceof k.XEditInteractor&&M._68I&&M._42()},X.isSnapPoint=function(){return!0};var xo=function(M){arguments.length>0&&this.$58l(M)},Df=xo.prototype;Df.$58l=function(O){this.$62l=O,this.points=new Array},Df.$56l=function(W){this.points.push(W)},Df.$57l=function(f){this.points=this.points.concat(f)};var cs=function(X,J){arguments.length>0&&this.$58l(X,J)},bl=cs.prototype;bl.$58l=function(Y,I){this.x=Y,this.y=I},bl.add=function(_){return new cs(this.x+_.x,this.y+_.y)},bl.addEquals=function(O){return this.x+=O.x,this.y+=O.y,this},bl.$55l=function(y){return new cs(this.x*y,this.y*y)},bl.eq=function(X){return this.x==X.x&&this.y==X.y},bl.lt=function(G){return this.x<G.x&&this.y<G.y},bl.lte=function(i){return this.x<=i.x&&this.y<=i.y},bl.gt=function(M){return this.x>M.x&&this.y>M.y},bl.gte=function(I){return this.x>=I.x&&this.y>=I.y},bl.lerp=function(f,W){return new cs(this.x+(f.x-this.x)*W,this.y+(f.y-this.y)*W)},bl.distanceFrom=function(D){var l=this.x-D.x,G=this.y-D.y;return J(l*l+G*G)},bl.min=function(K){return new cs($(this.x,K.x),$(this.y,K.y))},bl.max=function(e){return new cs(o(this.x,e.x),o(this.y,e.y))},bl.toString=function(){return this.x+","+this.y};var lb=function(){this.$58l(arguments)},To=lb.prototype;lb.TO=1e-6,lb.AC=6,To.$58l=function(_){this.co=new Array;for(var t=_.length-1;t>=0;t--)this.co.push(_[t])},To.$55l=function(M){for(var d=new lb,W=0;W<=this.$50l()+M.$50l();W++)d.co.push(0);for(var W=0;W<=this.$50l();W++)for(var N=0;N<=M.$50l();N++)d.co[W+N]+=this.co[W]*M.co[N];return d},To.$59l=function(){for(var T=this.$50l();T>=0&&F(this.co[T])<=lb.TO;T--)this.co.pop()},To.$50l=function(){return this.co.length-1},To.$51l=function(){var D;switch(this.$59l(),this.$50l()){case 0:D=new Array;break;case 1:D=this.$52l();break;case 2:D=this.$53l();break;case 3:D=this.$54l();break;case 4:D=this.$63l();break;default:D=new Array}return D},To.$52l=function(){var a=new Array,v=this.co[1];return 0!=v&&a.push(-this.co[0]/v),a},To.$53l=function(){var v=new Array;if(2==this.$50l()){var z=this.co[2],C=this.co[1]/z,I=this.co[0]/z,O=C*C-4*I;if(O>0){var y=J(O);v.push(.5*(-C+y)),v.push(.5*(-C-y))}else 0==O&&v.push(.5*-C)}return v},To.$63l=function(){var l=new Array;if(4==this.$50l()){var p=this.co[4],s=this.co[3]/p,S=this.co[2]/p,r=this.co[1]/p,k=this.co[0]/p,a=new lb(1,-S,s*r-4*k,-s*s*k+4*S*k-r*r).$54l(),X=a[0],I=s*s/4-S+X;if(F(I)<=lb.TO&&(I=0),I>0){var G=J(I),d=3*s*s/4-G*G-2*S,g=(4*s*S-8*r-s*s*s)/(4*G),f=d+g,e=d-g;if(F(f)<=lb.TO&&(f=0),F(e)<=lb.TO&&(e=0),f>=0){var O=J(f);l.push(-s/4+(G+O)/2),l.push(-s/4+(G-O)/2)}if(e>=0){var O=J(e);l.push(-s/4+(O-G)/2),l.push(-s/4-(O+G)/2)}}else if(0>I);else{var g=X*X-4*k;if(g>=-lb.TO){if(0>g&&(g=0),g=2*J(g),d=3*s*s/4-2*S,d+g>=lb.TO){var v=J(d+g);l.push(-s/4+v/2),l.push(-s/4-v/2)}if(d-g>=lb.TO){var v=J(d-g);l.push(-s/4+v/2),l.push(-s/4-v/2)}}}}return l},To.$54l=function(){var T=new Array;if(3==this.$50l()){var W=this.co[3],o=this.co[2]/W,m=this.co[1]/W,H=this.co[0]/W,q=(3*m-o*o)/3,r=(2*o*o*o-9*m*o+27*H)/27,Q=o/3,j=r*r/4+q*q*q/27,i=r/2;if(F(j)<=lb.TO&&(j=0),j>0){var Y,f,l=J(j);Y=-i+l,f=Y>=0?O(Y,1/3):-O(-Y,1/3),Y=-i-l,Y>=0?f+=O(Y,1/3):f-=O(-Y,1/3),T.push(f-Q)}else if(0>j){var M=J(-q/3),R=S(J(-j),-i)/3,x=w(R),V=N(R),Z=J(3);T.push(2*M*x-Q),T.push(-M*(x+Z*V)-Q),T.push(-M*(x-Z*V)-Q)}else{var Y;Y=i>=0?-O(i,1/3):O(-i,1/3),T.push(2*Y-Q),T.push(-Y-Q)}}return T};var Yr=function(g,X){arguments.length>0&&this.$58l(g,X)},od=Yr.prototype;od.$58l=function(C,$){this.x=C,this.y=$},od.length=function(){return J(this.x*this.x+this.y*this.y)},od.$60l=function(d){return this.x*d.x+this.y*d.y};var Xh=function(K,d,u,t){var c,e=(t.x-u.x)*(K.y-u.y)-(t.y-u.y)*(K.x-u.x),T=(d.x-K.x)*(K.y-u.y)-(d.y-K.y)*(K.x-u.x),j=(t.y-u.y)*(d.x-K.x)-(t.x-u.x)*(d.y-K.y);if(0!=j){var Y=e/j,G=T/j;Y>=0&&1>=Y&&G>=0&&1>=G?(c=new xo(i),c.points.push(new cs(K.x+Y*(d.x-K.x),K.y+Y*(d.y-K.y)))):c=new xo(A)}else c=0==e||0==T?new xo("C"):new xo("P");return c},io=function(o,p,Y,E,y){var C,j,Z,R,z,b,V,O=E.min(y),v=E.max(y),s=new xo(A);C=p.$55l(-2),Z=o.add(C.add(Y)),C=o.$55l(-2),j=p.$55l(2),R=C.add(j),z=new cs(o.x,o.y),V=new Yr(E.y-y.y,y.x-E.x),b=E.x*y.y-y.x*E.y;for(var U=new lb(V.$60l(Z),V.$60l(R),V.$60l(z)+b).$51l(),K=0;K<U.length;K++){var F=U[K];if(F>=0&&1>=F){var $=o.lerp(p,F),G=p.lerp(Y,F),H=$.lerp(G,F);E.x==y.x?O.y<=H.y&&H.y<=v.y&&(s.$62l=i,s.$56l(H)):E.y==y.y?O.x<=H.x&&H.x<=v.x&&(s.$62l=i,s.$56l(H)):H.gte(O)&&H.lte(v)&&(s.$62l=i,s.$56l(H))}}return s},Zo=function(q,T,y,c,L){var R=c.min(L),S=c.max(L),B=new cs(S.x,R.y),Q=new cs(R.x,S.y),g=io(q,T,y,R,B),F=io(q,T,y,B,S),b=io(q,T,y,S,Q),P=io(q,T,y,Q,R),H=new xo(A);return H.$57l(g.points),H.$57l(F.points),H.$57l(b.points),H.$57l(P.points),H.points.length>0&&(H.$62l=i),H},Sr=function(M,G,t,T,x,l){var f,r,Y,O,d,S,W,H,c,u,n=x.min(l),q=x.max(l),B=new xo(A);f=M.$55l(-1),r=G.$55l(3),Y=t.$55l(-3),O=f.add(r.add(Y.add(T))),d=new Yr(O.x,O.y),f=M.$55l(3),r=G.$55l(-6),Y=t.$55l(3),O=f.add(r.add(Y)),S=new Yr(O.x,O.y),f=M.$55l(-3),r=G.$55l(3),Y=f.add(r),W=new Yr(Y.x,Y.y),H=new Yr(M.x,M.y),u=new Yr(x.y-l.y,l.x-x.x),c=x.x*l.y-l.x*x.y;for(var v=new lb(u.$60l(d),u.$60l(S),u.$60l(W),u.$60l(H)+c).$51l(),K=0;K<v.length;K++){var R=v[K];if(R>=0&&1>=R){var J=M.lerp(G,R),Z=G.lerp(t,R),Q=t.lerp(T,R),e=J.lerp(Z,R),L=Z.lerp(Q,R),_=e.lerp(L,R);x.x==l.x?n.y<=_.y&&_.y<=q.y&&(B.$62l=i,B.$56l(_)):x.y==l.y?n.x<=_.x&&_.x<=q.x&&(B.$62l=i,B.$56l(_)):_.gte(n)&&_.lte(q)&&(B.$62l=i,B.$56l(_))}}return B},Bn=function(z,p,N,Y,r,F){var S=r.min(F),n=r.max(F),m=new cs(n.x,S.y),K=new cs(S.x,n.y),c=Sr(z,p,N,Y,S,m),b=Sr(z,p,N,Y,m,n),l=Sr(z,p,N,Y,n,K),J=Sr(z,p,N,Y,K,S),D=new xo(A);return D.$57l(c.points),D.$57l(b.points),D.$57l(l.points),D.$57l(J.points),D.points.length>0&&(D.$62l=i),D},bg=function(o,E,Q,S){var k=Q.min(S),V=Q.max(S),C=new cs(V.x,k.y),X=new cs(k.x,V.y),g=Xh(k,C,o,E),n=Xh(C,V,o,E),U=Xh(V,X,o,E),L=Xh(X,k,o,E),O=new xo(A);return O.$57l(g.points),O.$57l(n.points),O.$57l(U.points),O.$57l(L.points),O.points.length>0&&(O.$62l=i),O},Jl=k.XEditInteractor=function(d){var P=this,n=P._view=document.createElement("canvas");n.className="editCanvas",n.style.position="absolute",Jl.superClass.constructor.call(P,d)};T.def(Jl,k.Interactor,{ms_edit:1,setUp:function(){var J=this,p=J.gv,x=p.getView(),S=J._view;Jl.superClass.setUp.call(J),p.setEditInteractor(J),p.$14l=S,p._79O?x.insertBefore(S,p._79O):x.appendChild(S);var B=J.$49l=J.$11l.bind(J);p.dm().md(B),p.sm().ms(B),p.mp(B)},tearDown:function(){var s=this,Y=s.gv,I=Y.getView(),c=s.$49l;Jl.superClass.tearDown.call(s),Y.setEditInteractor(R),Y.$14l=R,I.removeChild(s._view),Y.dm().umd(c),Y.sm().ums(c),Y.ump(c)},clear:function(){var R=this,$=R.gv;delete R._hoverSegmentIndex,delete R._edge,delete R._shape,delete $._editing,delete R.$10l,delete R.$13l,delete R.$9l,delete R._removePointIndex,delete R._lp,R.$12l="",delete R.$40l,delete R.$67l,delete R.$72l,delete R.$73l,delete R.$75l,delete R.$1l,delete R.$3l,delete R.$2l,delete R.$92l,delete R.$93l,delete R.$94l,R.clearDragging()},handle_keydown:function(d){this.$48l!==d.shiftKey&&(this.$48l=d.shiftKey,this.handle_mousemove(d,U,!0))},handle_keyup:function(b){this.$48l!==b.shiftKey&&(this.$48l=b.shiftKey,this.handle_mousemove(b,U,!0))},handle_touchstart:function(w){this.handle_mousemove(w),this.handle_mousedown(w)},handle_mousedown:function(i){I(i);var E=this,n=E.$13l,h=E.gv,e=h.dm(),x=h.sm(),U=h.getZoom(),u=h.lp(i),Y=T.isDoubleClick(i),O=T.isLeftButton(i),W=E.$7l,m=E._shape,o=E._hoverSegmentIndex,J=E._edge,H=E.$87l,B=E.$88l,l=function(){E._68I||H===E.$87l&&B===E.$88l||E.$43l()};if(7!==E.$67l&&(delete E.$87l,delete E.$88l),O&&(m||J)&&o>=0&&Y&&(m&&x.contains(m)||J&&x.contains(J))){var w=Pq.call(E,m||J,o,u);return E.addShapePoint(m||J,o,w),v(function(){E.handle_mousemove(i)},40),void 0}if(O&&(m||J)&&E._removePointIndex>=0&&Y)return E.removeShapePoint(),E.$5l=1,v(function(){E.handle_mousemove(i)},40),void 0;if(!O||!h._editing)return l(),void 0;if(m&&n>=0){var b=m.getPoints().get(n),g=m.p(),$=Sb(g,b.x-g.x,b.y-g.y,-W+m.getRotation());z=Sb(g,u.x-g.x,u.y-g.y,-W),E.$24l={x:z.x-$.x,y:z.y-$.y},E.startDragging(i),e.beginTransaction(),E.fi({kind:"beginEditPoint",event:i,data:m,index:n}),E.$88l=n,E.$87l=m}else if(E.$10l){var a=h.sm().getSelection(),A=E.$6l,Q=E.$1l={},X=E.$3l={},f=E.$16l[s[E.$10l]],k={x:A.x,y:A.y},c={x:A.x+A.width/2,y:A.y+A.height/2};E.$24l={x:u.x-f.x/U,y:u.y-f.y/U},E.$2l=p(E.$8l),E.$4l=p(A),a.each(function(K){if(K instanceof t){var Z=K.p(),N=K.getWidth(),m=K.getHeight(),o=Sb(c,Z.x-c.x,Z.y-c.y,-W);Q[K.getId()]={x:Z.x-N/2,y:Z.y-m/2,width:N,height:m},X[K.getId()]={x:(o.x-k.x)/A.width,y:(o.y-k.y)/A.height}}}),E.startDragging(i),e.beginTransaction(),E.fi({kind:"beginEditRect",event:i,direction:E.$10l})}else if(J&&n>=0){var N=lp(h.getDataUI(J),J.s("edge.points")),b=N.get(n);E.$24l={x:u.x-b.x,y:u.y-b.y},E.startDragging(i),e.beginTransaction(),E.fi({kind:"beginEditPoint",event:i,data:J,index:n}),E.$88l=n,E.$87l=J}else if(E.$40l){var A=E.$6l,c={x:A.x+A.width/2,y:A.y+A.height/2},j=p(E.$23l);j.x/=U,j.y/=U;var y=Sb(c,j.x-c.x,j.y-c.y,-W),z=Sb(c,u.x-c.x,u.y-c.y,-W);E.$24l={x:z.x-y.x,y:z.y-y.y},E.startDragging(i),e.beginTransaction(),E.fi({kind:"beginEditRotation",event:i,data:E._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(E.$67l)>=0){var Z=E.$67l;(7===Z||8===Z||9===Z)&&e.beginTransaction(),E.startDragging(i)}else if(E.$71l&&Y&&E.$79l(E.$71l,u)){var V=x.toSelection();e.beginTransaction(),V.each(function(s){e.remove(s)}),e.endTransaction()}l()},$11l:function(){var k=this,C=k.gv;C._editing&&(k.$13l==R||k._shape==R&&k._edge==R)&&(k.$73l==R||1!==k.$67l&&5!==k.$67l&&6!==k.$67l)||(k.$5l=1),k._68I=1},$46l:function(V){var c=this,t=c.gv,T=t.lp(V),N=[];return ys(t,function(V){var A=t.getDataUI(V);if(A){var h=A._79o();g(h,T)&&N.push(V)}}),N},$47l:function(a){var X=this,I=X.$13l,S=X.gv.dm();X.$10l?(X.fi({kind:"endEditRect",event:a,direction:X.$10l}),S.endTransaction()):X._shape&&I>=0?(X.fi({kind:"endEditPoint",event:a,data:X._shape,index:I}),S.endTransaction()):X._edge&&I>=0?(X.fi({kind:"endEditPoint",event:a,data:X._edge,index:I}),S.endTransaction()):X.$23l&&X.$40l&&(X.fi({kind:"endEditRotation",event:a}),S.endTransaction())},handleWindowTouchEnd:function($){this.handleWindowMouseUp($)},handleWindowMouseUp:function(z){var W=this,q=W.gv,Y=q.dm(),c=W._shape,F=W._edge,O=W.$13l,o=W.$40l,X=W.$9l,V=W.$10l,Q=W.$67l;if((c||F)&&O>=0&&X>=0){var v,I;if(c){var m=c.p(),E=c.getRotation();v=c.getPoints(),I=v.get(X),Bb(c,m,E,O,I,!1)}else if(v=lp(q.getDataUI(F),F.s("edge.points"),!0),I=v.get(X),0===O){var C=v.get(0);F.s("edge.source.offset.x",I.x-C.x),F.s("edge.source.offset.y",I.y-C.y)}else if(O===v.size()-1){var x=v.get(v.size()-1);F.s("edge.target.offset.x",I.x-x.x),F.s("edge.target.offset.y",I.y-x.y)}else"points"===F.s("edge.type")&&(v.set(O,I),F.s("edge.points",vb(v)))}W.$47l(z);var r=W.$73l;1===Q?(Y.beginTransaction(),r?q.sm().each(function(J){if(J.setHost&&q.isHelperEditable(J,"host")){J.setHost(r);
var N=W.$75l,D=W.$74l;N&&(J.s("attach.row.index",N.rowIndex),J.s("attach.column.index",N.columnIndex)),D&&(J.s("attach.index",D.attachIndex),J.s("attach.offset",D.attachOffset),J.s("attach.offset.relative",!1),J.s("attach.offset.opposite",!1))}}):q.sm().each(function(u){u.setHost&&q.isHelperEditable(u,"host")&&(u.setHost(R),u.s("attach.row.index",U),u.s("attach.column.index",U),u.s("attach.index",U),u.s("attach.offset",U),u.s("attach.offset.relative",!1),u.s("attach.offset.opposite",!1))}),Y.endTransaction()):2===Q?(Y.beginTransaction(),r?q.sm().each(function(E){E.setParent&&q.isHelperEditable(E,"parent")&&E.setParent(r)}):q.sm().each(function(U){U.setParent&&q.isHelperEditable(U,"parent")&&U.setParent(R)}),Y.endTransaction()):3===Q?r&&(Y.beginTransaction(),q.sm().each(function(T){if(q.isHelperEditable(T,"edge")&&T instanceof t&&r instanceof t){var h=new l.Edge;Y.add(h),h.setSource(T),h.setTarget(r),W.onEdgeCreated&&W.onEdgeCreated(z,h)}}),Y.endTransaction()):5===Q||6===Q?r&&(Y.beginTransaction(),q.sm().each(function(h){h instanceof u&&r instanceof t&&(5===Q&&q.isHelperEditable(h,"source")?h.setSource(r):6===Q&&q.isHelperEditable(h,"source")&&h.setTarget(r))}),Y.endTransaction()):(7===Q||8===Q||9===Q)&&Y.endTransaction(),(V||o)&&W.$43l(!0),n?(W.clear(),delete W.$64l,W._68I||W.$43l()):(W.handle_mousemove(z,!0),Q&&!W._68I&&W.$43l())},handleWindowTouchMove:function(D){this.handleWindowMouseMove(D)},handleWindowMouseMove:function(l){this._78I(l)},handle_mousemove:function(f,J,Z){if(!this._pause){if(!Z){var Y=n?Ff(f):f;this.$61l={clientX:Y.clientX,clientY:Y.clientY}}if(J===!0||!Q()){var h=this,S=h.gv,N=!1,K=R;h.clear(),S.sm().size()>0&&(K=S.lp(Z?h.$61l:f),N=h._79I(f,K)),N&&(S._editing=1),h.$12l!==h.$65l&&(h.$65l=h.$12l,h.setCursor(h.$12l)),h.$40l!==h.$64l&&(h.$64l=h.$40l,h._68I||h.$43l()),h._hoverSegmentIndex!==h.$66l&&(h.$66l=h._hoverSegmentIndex,h._68I||h.$43l())}}},_78I:function(b){this.autoScroll(b);var P=this,o=P.gv,i=o.lp(b),I=o.getZoom(),k=P.$13l;if((P._shape||P._edge)&&k>=0){var g,e,B,N=P._shape,V=P._edge,Z=P.$24l,j=o.getPointSnapSpacing(),m=function(Y,X){return j==R||isNaN(j)?{x:Y,y:X}:{x:r(Y/j)*j,y:r(X/j)*j}};if(N){g=N.getPoints();var G=N.p(),O=N.getRotation(),W=0;e=Sb(G,i.x-G.x,i.y-G.y,-O),Bb(N,G,O,k,i,!0,Z,m),P.fi({kind:"betweenEditPoint",event:b,data:N,index:k})}else if(V){g=lp(o.getDataUI(V),V.s("edge.points"),!0),i.x-=Z.x,i.y-=Z.y,e=i;var U,q,Q=V.s("edge.offset"),s=g.size(),Y=s>2;if(0===k){var L=g.get(0);Q&&(L=um(L,g.get(1),-Q,Y),i=um(i,g.get(1),-Q,Y)),U=i.x-L.x,q=i.y-L.y,B=m(U,q),V.s("edge.source.offset.x",B.x),V.s("edge.source.offset.y",B.y)}else if(k===s-1){var D=g.get(s-1);Q&&(D=um(D,g.get(s-2),-Q,Y),i=um(i,g.get(s-2),-Q,Y)),U=i.x-D.x,q=i.y-D.y,B=m(U,q),V.s("edge.target.offset.x",B.x),V.s("edge.target.offset.y",B.y)}else"points"===V.s("edge.type")&&(B=m(i.x,i.y),B.e=g.get(k).e,g.set(k,B),V.s("edge.points",vb(g)));P.fi({kind:"betweenEditPoint",event:b,data:V,index:k})}if(delete P.$9l,o.isSnapPoint(N)||o.isSnapPoint(V))for(W=0;W<g.size();W++)if(W!==k){var l=g.get(W);if(h(l,e)<o.getEditPointSize()/I){P.$9l=W;break}}}else if(P.$10l){var Z=P.$24l;i.x-=Z.x,i.y-=Z.y;var y=o.sm().getSelection(),w=P.$1l,H=P.$7l,M=P.$10l,f=P.$4l,c=P.$2l,X=o.getEditRectPadding()/I,z=2*X,A=o.getSnapSpacing(),K=A!=R&&!isNaN(A),p=uf(c,i,M,H,2*X,o.getResizeMode(),K,!0),$=P.$6l;if(K){var C=p.width-z,_=p.height-z,n=r(C/A)*A,Mb=r(_/A)*A,nr=n-C,Kq=Mb-_;("west"===M||"northwest"===M||"southwest"===M)&&(nr=-nr),("north"===M||"northwest"===M||"northeast"===M)&&(Kq=-Kq),p=uf(c,i,M,H,2*X,o.getResizeMode(),K,!1,nr,Kq)}P.$8l=p,$.x=p.x+X,$.y=p.y+X,$.width=p.width-z,$.height=p.height-z;var $i=p.x+p.width/2,gl=p.y+p.height/2,mj=$.x,dg=$.y,Gm=$.width/f.width,Fn=$.height/f.height;y.each(function(i){if(i instanceof t&&o.isEditable(i)&&o.isRectEditable(i)){var X=w[i.getId()],l=P.$3l[i.getId()],u={x:X.x+X.width/2,y:X.y+X.height/2},d=0,q=0,U=M,x=180*F(H-i.getRotation())/E;"northeast"===M?x>=315||45>x?(d=X.width*Gm+X.x,q=X.height*(1-Fn)+X.y,U="northeast"):x>=45&&135>x?(d=X.width*(1-Fn)+X.x,q=X.height*(1-Gm)+X.y,U="northwest"):x>=135&&225>x?(d=X.width*(1-Gm)+X.x,q=X.height*Fn+X.y,U="southwest"):(d=X.width*Fn+X.x,q=X.height*Gm+X.y,U="southeast"):"north"===M?x>=315||45>x?(q=X.height*(1-Fn)+X.y,U="north"):x>=45&&135>x?(d=X.width*(1-Fn)+X.x,U="west"):x>=135&&225>x?(q=X.height*Fn+X.y,U="south"):(d=X.width*Fn+X.x,U="east"):"northwest"===M?x>=315||45>x?(d=X.width*(1-Gm)+X.x,q=X.height*(1-Fn)+X.y,U="northwest"):x>=45&&135>x?(d=X.width*(1-Fn)+X.x,q=X.height*Gm+X.y,U="southwest"):x>=135&&225>x?(d=X.width*Gm+X.x,q=X.height*Fn+X.y,U="southeast"):(d=X.width*Fn+X.x,q=X.height*(1-Gm)+X.y,U="northeast"):"west"===M?x>=315||45>x?(d=X.width*(1-Gm)+X.x,U="west"):x>=45&&135>x?(q=X.height*Gm+X.y,U="south"):x>=135&&225>x?(d=X.width*Gm+X.x,U="east"):(q=X.height*(1-Gm)+X.y,U="north"):"southwest"===M?x>=315||45>x?(d=X.width*(1-Gm)+X.x,q=X.height*Fn+X.y,U="southwest"):x>=45&&135>x?(d=X.width*Fn+X.x,q=X.height*Gm+X.y,U="southeast"):x>=135&&225>x?(d=X.width*Gm+X.x,q=X.height*(1-Fn)+X.y,U="northeast"):(d=X.width*(1-Fn)+X.x,q=X.height*(1-Gm)+X.y,U="northwest"):"east"===M?x>=315||45>x?(d=X.width*Gm+X.x,U="east"):x>=45&&135>x?(q=X.height*(1-Gm)+X.y,U="north"):x>=135&&225>x?(d=X.width*(1-Gm)+X.x,U="west"):(q=X.height*Gm+X.y,U="south"):"south"===M?x>=315||45>x?(q=X.height*Fn+X.y,U="south"):x>=45&&135>x?(d=X.width*Fn+X.x,U="east"):x>=135&&225>x?(q=X.height*(1-Fn)+X.y,U="north"):(d=X.width*(1-Fn)+X.x,U="west"):"southeast"===M&&(x>=315||45>x?(d=X.width*Gm+X.x,q=X.height*Fn+X.y,U="southeast"):x>=45&&135>x?(d=X.width*Fn+X.x,q=X.height*(1-Gm)+X.y,U="northeast"):x>=135&&225>x?(d=X.width*(1-Gm)+X.x,q=X.height*(1-Fn)+X.y,U="northwest"):(d=X.width*(1-Fn)+X.x,q=X.height*Gm+X.y,U="southwest"));var I=Sb(u,d-u.x,q-u.y,i.getRotation());cr(i,X,U,{x:I.x,y:I.y});var c=mj+$.width*l.x,y=dg+$.height*l.y,g={x:c,y:y};g=Sb({x:$i,y:gl},g.x-$i,g.y-gl,H),i.p(g.x,g.y)}}),P.fi({kind:"betweenEditRect",event:b,direction:M})}else if(P.$23l&&P.$40l){var Do=P.$8l,kr=Do.width,De=Do.height,G={x:Do.x+kr/2,y:Do.y+De/2},Z=P.$24l,jm=P.$23l,Yq=jm.x/I-G.x,ll=jm.y/I-G.y,sj=J(Yq*Yq+ll*ll),Fb=Math.asin(Z.x/sj),Yi=o.sm().getSelection(),Yo=d+S(i.y-G.y,i.x-G.x)-Fb,hm=o.getSnapAngle(),Yo=r(Yo/hm)*hm;0>Yo&&(Yo+=a);var lb=Yo-P.$7l,ql=[G.x,0,G.y];Yi.each(function(g){if(o.isEditable(g)&&o.isRotationEditable(g)&&o.isVisible(g)){var v=zl(g.p3(),ql),N=Mc();gr(N,-lb),g.setRotation(g.getRotation()+lb),Li(v,N),g.p3(ql[0]+v[0],ql[1]+v[1],ql[2]+v[2])}}),P.$7l=Yo,P.fi({kind:"betweenEditRotation",event:b})}else if([1,2,3,5,6].indexOf(P.$67l)>=0)P.$72l=b,P.$78l||(P.$78l=1,v(function(){T.isDragging()&&P.$43l(),delete P.$78l},12));else if(7===P.$67l){if(P.$87l instanceof x){var N=P.$87l,bg=P.$88l,Ag=T.clone(N.getPoints().get(bg)),Kn=i.y-Ag.y;Ag.e||(Ag.e=0),P.$92l||(P.$92l=Ag.e),Ag.e=P.$92l-Kn,N.setPoint(bg,Ag)}else if(P.$87l instanceof u){var V=P.$87l,bg=P.$88l,g=lp(o.getDataUI(V),V.s("edge.points")),Ag=g.get(bg),Kn=i.y-Ag.y;Ag.e||(Ag.e=0),P.$92l||(P.$92l=Ag.e),Ag.e=P.$92l-Kn,g.set(bg,Ag),V.s("edge.points",vb(g))}}else if(8===P.$67l){var Yi=o.sm().getSelection(),Xe=P.$93l;Xe||(Xe=P.$93l={}),Yi.each(function(Z){if(Z.p3){var Q=Z.p3(),w=Xe[Z.getId()];w==R&&(w=Xe[Z.getId()]=Q[1]),Z.p3([Q[0],w-(i.y-P.$90l.y/I),Q[2]])}})}else if(9===P.$67l){var Yi=o.sm().getSelection(),Ve=P.$94l;Ve||(Ve=P.$94l={}),Yi.each(function(j){if(j.s3){var v=j.s3(),n=Ve[j.getId()];n==R&&(n=Ve[j.getId()]=v[1]);var c=n-(i.y-P.$91l.y/I);0>c&&(c=.01),j.s3([v[0],c,v[2]])}})}},$79l:function(t,Q){var u=this,F=u.gv,A=F.getZoom(),E=F.getEditHelperSize(),l=t.x/A,R=t.y/A,T=E/A,z=T/2;return g({x:l-z,y:R-z,width:T,height:T},Q)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(B,D){for(var G=this,Y=G.gv,R=Y.getZoom(),X=Y.getEditPointSize(),j=X/R,i=j/2,o=G.$46l(B),t=0;t<o.length;t++){var Z,k,T=o[t],U=Y.getDataUI(T);if(U&&U._55O){var w=U._55O;if(w._43O&&T instanceof u){if(Z=T.s("edge.points"),Z=lp(U,Z),k=T.s("edge.segments"),k&&k.size()||(k=He(Z)),G.$42l(T,D,Z._as,k,"edge"))return!0;if("points"===T.s("edge.type")&&G.$41l(T,D,Z._as,k,"edge"))return}if(w._43O&&T instanceof x&&w.$15l&&w.$15l.length===T.getPoints().size()){if(Z=w.$15l,k=T.getSegments(),k&&k.size()||(k=He(Z)),G.$42l(T,D,Z,k,"shape"))return!0;if(G.$41l(T,D,Z,k,"shape"))return}}}if(G.$16l){var Z,M=G.$16l,S=M[3].x-M[7].x,n=M[3].y-M[7].y,Q=J(S*S+n*n),$=M[1].x-M[5].x,V=M[1].y-M[5].y,N=J($*$+V*V),s={x:D.x*R,y:D.y*R};if(G._80I(s,0,M[0],"northwest",Q,N)||G._80I(s,1,M[1],"north",Q,N)||G._80I(s,2,M[2],"northeast",Q,N)||G._80I(s,7,M[7],"west",Q,N)||G._80I(s,3,M[3],"east",Q,N)||G._80I(s,6,M[6],"southwest",Q,N)||G._80I(s,5,M[5],"south",Q,N)||G._80I(s,4,M[4],"southeast",Q,N))return!0}if(G.$23l){var A=G.$23l,r=A.x/R,z=A.y/R;if(g({x:r-i,y:z-i,width:j,height:j},D))return G.$40l=1,G.$12l=G.getHelperCursor("rotation")||"crosshair",!0}return G.$68l&&G.$79l(G.$68l,D)?(G.$67l=1,G.$12l=G.getHelperCursor("host")||"crosshair",!0):G.$69l&&G.$79l(G.$69l,D)?(G.$67l=2,G.$12l=G.getHelperCursor("parent")||"crosshair",!0):G.$70l&&G.$79l(G.$70l,D)?(G.$67l=3,G.$12l=G.getHelperCursor("edge")||"crosshair",!0):G.$71l&&G.$79l(G.$71l,D)?(G.$67l=4,G.$12l=G.getHelperCursor("remove")||"crosshair",!0):G.$82l&&G.$79l(G.$82l,D)?(G.$67l=5,G.$12l=G.getHelperCursor("source")||"crosshair",!0):G.$83l&&G.$79l(G.$83l,D)?(G.$67l=6,G.$12l=G.getHelperCursor("target")||"crosshair",!0):G._pointElevationHelperPoint&&G.$79l(G._pointElevationHelperPoint,D)?(G.$67l=7,G.$12l=G.getHelperCursor("pointElevation")||"crosshair",!0):G.$90l&&G.$79l(G.$90l,D)?(G.$67l=8,G.$12l=G.getHelperCursor("elevation")||"crosshair",!0):G.$91l&&G.$79l(G.$91l,D)?(G.$67l=9,G.$12l=G.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(e,k,q,V,f,u){var Y=this,x=Y.gv,m=x.getEditPointSize(),r=m/2,K=x.sm(),I=x.isDirectionEditable;if(I&&1===K.size()){var T=K.ld();if(I=I.bind(x),T instanceof t){if(!I(T,V))return!1;if("east"===V){if(I(T,"northeast")&&I(T,"southeast")&&2*m>=u)return!1}else if("west"===V){if(I(T,"northwest")&&I(T,"southwest")&&2*m>=u)return!1}else if("north"===V){if(I(T,"northwest")&&I(T,"northeast")&&2*m>=f)return!1}else if("south"===V&&I(T,"southwest")&&I(T,"southeast")&&2*m>=f)return!1}}else{if(2*m>=f&&("north"===V||"south"===V))return!1;if(2*m>=u&&("east"===V||"west"===V))return!1}if(g({x:q.x-r,y:q.y-r,width:m,height:m},e)){if(Y.$10l!==V){var Q=180*Y.$7l/E,F="";Q>=337.5||22.5>Q?F="north":Q>=22.5&&67.5>Q?F="northeast":Q>=67.5&&112.5>Q?F="east":Q>=112.5&&157.5>Q?F="southeast":Q>=157.5&&202.5>Q?F="south":Q>=202.5&&247.5>Q?F="southwest":Q>=247.5&&292.5>Q?F="west":Q>=292.5&&337.5>Q&&(F="northwest");var O=Zl.indexOf(F),F=Zl[k-(1-O)+8];switch(F){case"northwest":Y.$12l="nwse-resize";break;case"northeast":Y.$12l="nesw-resize";break;case"southwest":Y.$12l="nesw-resize";break;case"southeast":Y.$12l="nwse-resize";break;case"north":Y.$12l="ns-resize";break;case"east":Y.$12l="ew-resize";break;case"south":Y.$12l="ns-resize";break;case"west":Y.$12l="ew-resize"}Y.$10l=V}return!0}return!1},$42l:function(_,T,y,D,S){var H,$=this,m=$.gv,G=m.getEditPointSize(),I=G/m.getZoom(),h=-1,t={x:T.x,y:T.y,width:0,height:0},z=function(Z){"shape"===S?$._shape=_:$._edge=_,$._removePointIndex=Z},e=function(j){"shape"===S?$._shape=_:$._edge=_,$.$13l=j,$.$12l="crosshair"};for(Y(t,I/2),h=y.length-1,H=D.size()-1;H>=0;H--){var c=D.get(H);if(1===c||2===c)h-=1;else if(3===c){var f=y[h-1];if(g(t,f))return e(h-1),!0;h-=2}else if(4===c){var N=y[h-1],V=y[h-2];if(g(t,N))return e(h-1),!0;if(g(t,V))return e(h-2),!0;h-=3}}for(h=y.length-1,H=D.size()-1;H>=0;H--){var c=D.get(H),Q=y[h];if(g(t,Q))return z(h),e(h),!0;1===c||2===c?h-=1:3===c?h-=2:4===c&&(h-=3)}return!1},$41l:function(s,y,k,e,A){var V=this,N=V.gv,L=-1,U=0,f={x:y.x,y:y.y,width:0,height:0},g=function(w,L){V._hoverSegmentIndex=L,V._lp=y,"shape"===A?V._shape=s:V._edge=s};for(Y(f,N.getSegmentHoverWidth()/2/N.getZoom()),s instanceof x&&s.isClosePath()&&e.indexOf(5)<0&&(e=new j(e._as),e.add(5));U<e.size();U++){var d=e.get(U);if(1===d){var _=k[L],W=k[L+1];if(_){var q=bg(new cs(_.x,_.y),new cs(W.x,W.y),new cs(f.x,f.y),new cs(f.x+f.width,f.y+f.height));if(q.$62l===i&&q.points.length>0)return g(q,U),!0}L+=1}else if(2===d){var _=k[L],W=k[L+1],q=bg(new cs(_.x,_.y),new cs(W.x,W.y),new cs(f.x,f.y),new cs(f.x+f.width,f.y+f.height));if(q.$62l===i&&q.points.length>0)return g(q,U),!0;L+=1}else if(3===d){var _=k[L],I=k[L+1],D=k[L+2],q=Zo(new cs(_.x,_.y),new cs(I.x,I.y),new cs(D.x,D.y),new cs(f.x,f.y),new cs(f.x+f.width,f.y+f.height));if(q.$62l===i)return g(q,U),!0;L+=2}else if(4===d){var _=k[L],G=k[L+1],o=k[L+2],D=k[L+3],q=Bn(new cs(_.x,_.y),new cs(G.x,G.y),new cs(o.x,o.y),new cs(D.x,D.y),new cs(f.x,f.y),new cs(f.x+f.width,f.y+f.height));if(q.$62l===i)return g(q,U),!0;L+=3}else if(5===d){var _=k[L],W=k[0];if(_){var q=bg(new cs(_.x,_.y),new cs(W.x,W.y),new cs(f.x,f.y),new cs(f.x+f.width,f.y+f.height));if(q.$62l===i&&q.points.length>0)return g(q,U),!0}}}return!1},addShapePoint:function(t,e,I){var z=this,V=z.gv,f=V.dm();if(f.beginTransaction(),0===arguments.length&&(t=z._shape||z._edge,e=z._hoverSegmentIndex,I=z._lp),t instanceof x||t instanceof u){var M=dm(t,V.getDataUI(t),e);if(!isNaN(e)&&I&&!isNaN(M)){var i=I;if(t instanceof x){var N=t.p(),B=t.getRotation(),b=t.toSegments();b&&b.size()||(b=He(t.getPoints())),t.isClosePath()&&b.indexOf(5)<0&&(b=new j(b._as),b.add(5));var y=b.get(e),q="addPoint",c="removePointAt";if(2===y||1===y){var G={x:i.x,y:i.y};b.add(y,e),G=Sb(N,G.x-N.x,G.y-N.y,-B),t[q](G,M+1)}else if(3===y){var p=t.getPoints(),s=p.get(M),$=p.get(M+2),G={x:i.x,y:i.y};G=Sb(N,G.x-N.x,G.y-N.y,-B);var a=af(s,G),n=af(G,$);b.removeAt(e),b.add(3,e),b.add(3,e),t.setPoint(M+1,G),t[q](n,M+2),t[q](a,M+1)}else if(4===y){var p=t.getPoints(),s=p.get(M),$=p.get(M+3),G={x:i.x,y:i.y};G=Sb(N,G.x-N.x,G.y-N.y,-B);var a=Tp(s,G),n=ie(s,G),T=Tp(G,$),m=ie(G,$);b.removeAt(e),b.add(4,e),b.add(4,e),t[c](M+1),t[c](M+1),t[q](G,M+1),t[q](m,M+2),t[q](T,M+2),t[q](n,M+1),t[q](a,M+1)}else if(5===y){var G={x:i.x,y:i.y};b.add(2,e),G=Sb(N,G.x-N.x,G.y-N.y,-B),t[q](G,M+1)}t.isClosePath()&&b.remove(5),t.setSegments(b);var Q=t.getWidth(),l=t.getHeight(),_=t.p().x-Q/2,F=t.p().y-l/2;_-=N.x,F-=N.y;var R=rl(t,{x:_,y:F,width:Q,height:l},B,N);t.p(R.x,R.y)}else if(t instanceof u){if("points"!==t.s("edge.type"))return f.endTransaction(),void 0;var p=t.s("edge.points");b=t.s("edge.segments"),p=lp(V.getDataUI(t),p),b&&b.size()||(b=He(p)),b=new j(b._as.slice(0)),p=new j(p._as.slice(0));var y=b.get(e);if(2===y||1===y){var G={x:i.x,y:i.y};b.add(y,e),p.add(G,M+1)}else if(3===y){var s=p.get(M),$=p.get(M+2),G={x:i.x,y:i.y},a=af(s,G),n=af(G,$);b.removeAt(e),b.add(3,e),b.add(3,e),p.set(M+1,G),p.add(n,M+2),p.add(a,M+1)}else if(4===y){var s=p.get(M),$=p.get(M+3),G={x:i.x,y:i.y},a=Tp(s,G),n=ie(s,G),T=Tp(G,$),m=ie(G,$);b.removeAt(e),b.add(4,e),b.add(4,e),p.removeAt(M+1),p.removeAt(M+1),p.add(G,M+1),p.add(m,M+2),p.add(T,M+2),p.add(n,M+1),p.add(a,M+1)}t.s("edge.points",vb(p)),t.s("edge.segments",b)}}}f.endTransaction()},removeShapePoint:function(t,M){var I=this,O="removeAt",q=I.gv,U=q.dm();if(U.beginTransaction(),0===arguments.length&&(t=I._shape||I._edge,M=I._removePointIndex),M>=0&&(t instanceof x||t instanceof u)){var B=yj(t,I.gv.getDataUI(t),M),A=M;if(t instanceof x){var K=t.p(),l=t.toSegments();l&&l.size()||(l=He(t.getPoints()));var Q=l.get(B),z="removePointAt";if(1===Q&&0===A)if(t.getPoints().size()>1){var S=l.get(B+1);l[O](B+1),3===S?t[z](A+1):4===S&&(t[z](A+2),t[z](A+1)),t[z](A)}else t.dm().remove(t);else 2===Q||1===Q?(l[O](B),t[z](A)):3===Q?(l[O](B),t[z](A),t[z](A-1)):4===Q&&(l[O](B),t[z](A),t[z](A-1),t[z](A-2));t.setSegments(l);var X=t.getWidth(),m=t.getHeight(),i=t.p().x-X/2,W=t.p().y-m/2;i-=K.x,W-=K.y;var F=rl(t,{x:i,y:W,width:X,height:m},t.getRotation(),K);t.p(F.x,F.y)}else if(t instanceof u){if("points"!==t.s("edge.type"))return U.endTransaction(),void 0;var E=t.s("edge.points");if(l=t.s("edge.segments"),E&&(E=lp(I.gv.getDataUI(t),E),l&&l.size()||(l=He(E))),0===M||M===E.size()-1)return U.endTransaction(),void 0;l=new j(l._as.slice(0)),E=new j(E._as.slice(0));var Q=l.get(B);2===Q||1===Q?(l[O](B),E[O](A)):3===Q?(l[O](B),E[O](A),E[O](A-1)):4===Q&&(l[O](B),E[O](A),E[O](A-1),E[O](A-2)),t.s("edge.segments",l),t.s("edge.points",vb(E))}}U.endTransaction()},changeShapeSegment:function(w,B,y){var $=this,M=$.gv,F=M.dm();if(F.beginTransaction(),1!==arguments.length||isNaN(w)||(y=w,w=$._shape||$._edge,B=$._hoverSegmentIndex),w instanceof x||w instanceof u){var l=dm(w,$.gv.getDataUI(w),B);if(!isNaN(B)&&!isNaN(l))if(w instanceof x){var G=w.p(),d=w.toSegments();d&&d.size()||(d=He(w.getPoints()));var D=d.get(B),a=w.toPoints();if(1===y||2===y)1===D||2===D?d.set(B,y):3===D?(d.set(B,y),a.removeAt(l+1)):4===D&&(d.set(B,y),a.removeAt(l+1),a.removeAt(l+1));else if(3===y){var W=function(){var $=a.get(l),D=a.get(l+1),e=af($,D);d.set(B,3),a.add(e,l+1)};2===D||1===D?W():4===D&&(a.removeAt(l+1),a.removeAt(l+1),W())}else if(4===y){var H=function(){var p=a.get(l),k=a.get(l+1),U=Tp(p,k),L=ie(p,k);d.set(B,4),a.add(U,l+1),a.add(L,l+2)};2===D||1===D?H():3===D&&(a.removeAt(l+1),H())}w.setSegments(d),w.setPoints(a);var _=w.getWidth(),o=w.getHeight(),n=w.p().x-_/2,i=w.p().y-o/2;n-=G.x,i-=G.y;var s=new rl(w,{x:n,y:i,width:_,height:o},w.getRotation(),G);w.p(s.x,s.y)}else if(w instanceof u){if("points"!==w.s("edge.type"))return F.endTransaction(),void 0;var a=w.s("edge.points");d=w.s("edge.segments"),a&&(a=lp($.gv.getDataUI(w),a),d&&d.size()||(d=He(a))),d=new j(d._as.slice(0)),a=new j(a._as.slice(0));var D=d.get(B);if(1===y||2===y)1===D||2===D?d.set(B,y):3===D?(d.set(B,y),a.removeAt(l+1)):4===D&&(d.set(B,y),a.removeAt(l+1),a.removeAt(l+1));else if(3===y){var W=function(){var W=a.get(l),V=a.get(l+1),r=af(W,V);d.set(B,3),a.add(r,l+1)};2===D||1===D?W():4===D&&(a.removeAt(l+1),a.removeAt(l+1),W())}else if(4===y){var H=function(){var S=a.get(l),g=a.get(l+1),$=Tp(S,g),y=ie(S,g);d.set(B,4),a.add($,l+1),a.add(y,l+2)};2===D||1===D?H():3===D&&(a.removeAt(l+1),H())}w.s("edge.points",vb(a)),w.s("edge.segments",d)}}F.endTransaction()},getDefaultSegments:function(m){var s=this.gv,v=s.getDataUI(m);if(m instanceof u){var $=m.s("edge.points");return $=lp(v,$),He($)}if(m instanceof x){var $=m.getPoints(),i=m.getSegments();return i&&i.size()>0?i:He($)}},$43l:function(S){var f=this;S&&(f.$5l=1),f._68I=1,f._42()},_42:function(){var X=this;if(X._68I){delete X._68I;var $=X.gv,Z=X.$5l,L=$.getZoom(),c=$.getEditPointSize(),v=c/2,n=new j,w=X._view,h=X._edge,s=X._shape,Q=w.getContext("2d"),E=$.tx(),C=$.ty(),g=R,r=$.getEditPointBackground(),o=$.getControlPointBackground(),W=$.getControlPointBorderColor(),S=$.getEditPointBorderColor(),O=$.getEditRectBorderColor(),d=$.getDirectionLineColor(),A=$.getSegmentHoverColor(),B=$.getSnapPointBorderColor(),N=$.getJoinPointBackground(),k=$.getJoinPointBorderColor(),i=$.getSegmentHoverWidth(),U=[5,5],K=$.getEditRectBorderStyle();dn($,function(P){$.isSelected(P)&&$.isVisible(P)&&n.add(P)}),Q.clearRect(0,0,G(w.width),G(w.height)),Q.save(),P.translateAndScale(Q,E,C,1);var e=R,b={x:0,y:0,width:0,height:0},z=0,m=0,D=0,f=0,I=0,F=0,Dn=0,gk=0,ll=0,Eq=0,Qe=[];if(Z?(delete X.$6l,delete X.$8l,delete X.$7l,delete X.$16l,delete X.$23l):(e=X.$6l,g=X.$7l),delete X.$68l,delete X.$69l,delete X.$71l,delete X.$70l,delete X.$82l,delete X.$83l,delete X._pointElevationHelperPoint,delete X.$90l,delete X.$91l,delete X.$75l,delete X.$74l,n.each(function(O){var C=$.getDataUI(O);if(C){var T=C._55O;if($.isEditable(O))T._56O&&O instanceof t&&m++,Qe.push(O),T._42O&&O instanceof t&&z++,$.isHelperEditable(O,"host")&&f++,$.isHelperEditable(O,"parent")&&D++,$.isHelperEditable(O,"remove")&&I++,$.isHelperEditable(O,"edge")&&F++,$.isHelperEditable(O,"source")&&Dn++,$.isHelperEditable(O,"target")&&gk++,$.isHelperEditable(O,"elevation")&&ll++,$.isHelperEditable(O,"tall")&&Eq++;else if(O instanceof q&&O.isExpanded()){var h=!0,N=$.getEditableFunc();N&&(h=N(O)),h&&($.isHelperEditable(O,"host")&&f++,$.isHelperEditable(O,"parent")&&D++,$.isHelperEditable(O,"remove")&&I++,$.isHelperEditable(O,"edge")&&F++,$.isHelperEditable(O,"source")&&Dn++,$.isHelperEditable(O,"target")&&gk++,$.isHelperEditable(O,"elevation")&&ll++,$.isHelperEditable(O,"tall")&&Eq++,Qe.push(O))}}}),Q.beginPath(),Q.lineWidth=1,Q.strokeStyle=$.getNodeBorderColor(),Qe.forEach(function(G){var n=$.getDataUI(G),F=n._55O;if(Z)if(g==R&&(g=G instanceof u?0:G instanceof q&&G.isExpanded()?0:G.getRotation(),X.$7l=g),e==R){var h,M,j;if(G instanceof q&&G.isExpanded()||G instanceof u){var E=$.getDataUIBounds(G);M=E.width,j=E.height,h={x:E.x+M/2,y:E.y+j/2}}else h=G.p(),M=G.getWidth(),j=G.getHeight();e={x:h.x,y:h.y,width:0,height:0},b.x=h.x-M/2,b.y=h.y-j/2,b.width=M,b.height=j,e=H(e,b)}else{var h,M,j,I,y=e.x+e.width/2,J=e.y+e.height/2,p={x:y,y:J};if(G instanceof q&&G.isExpanded()||G instanceof u){I=0;var E=$.getDataUIBounds(G);M=E.width,j=E.height,h={x:E.x+M/2,y:E.y+j/2}}else h=G.p(),M=G.getWidth(),j=G.getHeight(),I=G.getRotation();var B={x:h.x-M/2,y:h.y-j/2,width:M,height:j},Y={x:B.x,y:B.y},T={x:B.x+B.width,y:B.y},W={x:B.x,y:B.y+B.height},K={x:B.x+B.width,y:B.y+B.height},Y=Sb(h,Y.x-h.x,Y.y-h.y,I),W=Sb(h,W.x-h.x,W.y-h.y,I),K=Sb(h,K.x-h.x,K.y-h.y,I),T=Sb(h,T.x-h.x,T.y-h.y,I),w=-g,U=Sb(p,Y.x-p.x,Y.y-p.y,w),k=Sb(p,T.x-p.x,T.y-p.y,w),v=Sb(p,W.x-p.x,W.y-p.y,w),P=Sb(p,K.x-p.x,K.y-p.y,w),o=V([U,k,v,P]);e=H(e,o),e.x-=y,e.y-=J;var f=rl(R,e,g,p);e.x=f.x-e.width/2,e.y=f.y-e.height/2}if(z>1&&$.isEditable(G)&&$.isRectEditable(G)&&G instanceof t){var d=G.getRect(),s=F.$45l,A=ur(s[0],L),x=ur(s[2],L),i=ur(s[4],L),l=ur(s[6],L);G.getRotation()?(Q.moveTo(A.x,A.y),Q.lineTo(x.x,x.y),Q.lineTo(i.x,i.y),Q.lineTo(l.x,l.y),Q.lineTo(A.x,A.y)):Q.rect(d.x*L,d.y*L,d.width*L,d.height*L)}}),Q.stroke(),e){X.$6l=p(e),Y(e,$.getEditRectPadding()/L);var qk={x:e.x+e.width/2,y:e.y+e.height/2},sm=Gf(qk,e.width,e.height,g),jg=sm[0],yh=sm[1],Kd=sm[2],De=sm[3],ns=sm[4],Tn=sm[5],cc=sm[6],Nk=sm[7];if(jg=ur(sm[0],L),yh=ur(sm[1],L),Kd=ur(sm[2],L),De=ur(sm[3],L),ns=ur(sm[4],L),Tn=ur(sm[5],L),cc=ur(sm[6],L),Nk=ur(sm[7],L),X.$8l=e,z>0&&(X.$16l=[jg,ns,yh,Tn,De,cc,Kd,Nk],Q.beginPath(),Q.lineWidth=1,Q.strokeStyle=O,"dashed"===K&&Q.setLineDash&&Q.setLineDash(U),Q.moveTo(jg.x,jg.y),Q.lineTo(yh.x,yh.y),Q.lineTo(De.x,De.y),Q.lineTo(Kd.x,Kd.y),Q.lineTo(jg.x,jg.y),Q.stroke(),"dashed"===K&&Q.setLineDash&&Q.setLineDash([])),Q.beginPath(),Q.lineWidth=1,Q.fillStyle=r,Q.strokeStyle=S,z>0){var Vf=Tn.x-Nk.x,ac=Tn.y-Nk.y,In=J(Vf*Vf+ac*ac),ep=ns.x-cc.x,Wh=ns.y-cc.y,Dc=J(ep*ep+Wh*Wh),kk=2*c;if($.isDirectionEditable&&1===Qe.length){var If=Qe[0],rj=$.getDataUI(If),ai=rj._55O,$l=$.isDirectionEditable.bind($);if(ai._42O){var Ml,Se,vl,Hg;$l(If,"northwest")&&(Ml=!0,Q.rect(jg.x-v,jg.y-v,c,c)),$l(If,"northeast")&&(Se=!0,Q.rect(yh.x-v,yh.y-v,c,c)),$l(If,"southwest")&&(vl=!0,Q.rect(Kd.x-v,Kd.y-v,c,c)),$l(If,"southeast")&&(Hg=!0,Q.rect(De.x-v,De.y-v,c,c)),$l(If,"north")&&(Ml&&Se?In>kk&&Q.rect(ns.x-v,ns.y-v,c,c):Q.rect(ns.x-v,ns.y-v,c,c)),$l(If,"south")&&(Hg&&vl?In>kk&&Q.rect(cc.x-v,cc.y-v,c,c):Q.rect(cc.x-v,cc.y-v,c,c)),$l(If,"west")&&(vl&&Ml?Dc>kk&&Q.rect(Nk.x-v,Nk.y-v,c,c):Q.rect(Nk.x-v,Nk.y-v,c,c)),$l(If,"east")&&(Hg&&Se?Dc>kk&&Q.rect(Tn.x-v,Tn.y-v,c,c):Q.rect(Tn.x-v,Tn.y-v,c,c))}}else In>kk&&(Q.rect(ns.x-v,ns.y-v,c,c),Q.rect(cc.x-v,cc.y-v,c,c)),Dc>kk&&(Q.rect(Tn.x-v,Tn.y-v,c,c),Q.rect(Nk.x-v,Nk.y-v,c,c)),Q.rect(jg.x-v,jg.y-v,c,c),Q.rect(yh.x-v,yh.y-v,c,c),Q.rect(Kd.x-v,Kd.y-v,c,c),Q.rect(De.x-v,De.y-v,c,c)}if(m>0){var Tb=X.$23l=Sb(ns,0,2*-c,g);Q.moveTo(Tb.x+v,Tb.y),Q.arc(Tb.x,Tb.y,v,0,a,!1)}Q.fill(),Q.stroke(),X.$40l&&X.$44l(Q,e,g);var fg,dd,Ue=$.getLeftTopHelpers(),Ub=$.getRightTopHelpers(),Rf=$.getLeftBottomHelpers(),yn=$.getRightBottomHelpers(),hq=$.getEdgeHelpers(),gl=$.getEditHelperSize(),Dm=gl/2,dg=function(b,m,q,j){"leftTop"===m?(fg=e.x*L-gl-v-("h"===j?q*(gl+v):0)-1,dd=e.y*L-gl-v-("v"===j?q*(gl+v):0)-1):"rightTop"===m?(fg=(e.x+e.width)*L+v+("h"===j?q*(gl+v):0)+1,dd=e.y*L-gl-v-("v"===j?q*(gl+v):0)-1):"leftBottom"===m?(fg=e.x*L-gl-v-("h"===j?q*(gl+v):0)-1,dd=(e.y+e.height)*L+v+("v"===j?q*(gl+v):0)+1):"rightBottom"===m&&(fg=(e.x+e.width)*L+v+("h"===j?q*(gl+v):0)+1,dd=(e.y+e.height)*L+v+("v"===j?q*(gl+v):0)+1);var V=fg+Dm,R=dd+Dm,G=(e.x+e.width/2)*L,y=(e.y+e.height/2)*L,S=Sb({x:G,y:y},V-G,R-y,g);if("host"===b){if(f>0)return X.$77l(Q,g,S),!0}else if("edge"===b){if(F>0)return X.$80l(Q,g,S),!0}else if("remove"===b){if(I>0)return Qe&&1===Qe.length&&Qe[0]instanceof u?X.$81l(Q,g,{x:G+gl/2+5,y:y}):X.$81l(Q,g,S),!0}else if("parent"===b){if(D>0)return Qe&&1===Qe.length&&Qe[0]instanceof u?X.$76l(Q,g,{x:G-gl/2-5,y:y}):X.$76l(Q,g,S),!0}else if("elevation"===b){if(ll>0)return X.$85l(Q,g,S),!0}else if("tall"===b){if(Eq>0)return X.$86l(Q,g,S),!0}else if("source"===b||"target"===b){var n=Qe[0],a=$.getDataUI(n),p=vr(a,!0),U=p[0],z=p[1];if(Dn&&"source"===b)return X.$84l(Q,e,U,!0,n.isLooped(),m,q,j),!0;if(gk&&"target"===b)return X.$84l(Q,e,z,!1,n.isLooped(),m,q,j),!0}};if(Ue&&Ue.length>0){var pr=0;Ue.forEach(function(n){dg(n,"leftTop",pr,$.getLeftTopHelpersAlign()||"h")&&pr++})}if(Ub&&Ub.length>0){var pr=0;Ub.forEach(function(I){dg(I,"rightTop",pr,$.getRightTopHelpersAlign()||"h")&&pr++})}if(Rf&&Rf.length>0){var pr=0;Rf.forEach(function(z){dg(z,"leftBottom",pr,$.getLeftBottomHelpersAlign()||"h")&&pr++})}if(yn&&yn.length>0){var pr=0;yn.forEach(function(p){dg(p,"rightBottom",pr,$.getRightBottomHelpersAlign()||"h")&&pr++})}if(hq&&hq.length>0&&((Dn||gk)&&Qe&&1===Qe.length&&Qe[0]instanceof u?!0:!1)){var pr=0;hq.forEach(function(s){dg(s,"edge",pr,"h")&&pr++})}if(X.$72l){var Ng,sj=X.$67l,nm=X.$68l,Xi=X.$69l,as=(X.$71l,X.$70l),Ln=X.$82l,Nm=X.$83l;if(1===sj?Ng=nm:2===sj?Ng=Xi:3===sj?Ng=as:5===sj?Ng=Ln:6===sj&&(Ng=Nm),Ng){var wl=$.lp(X.$72l),Th=$.getDataAt(X.$72l);if(Th&&Th instanceof t){var ul,Fk,_p;if(X.$73l=Th,1===sj)if(Th instanceof l.Grid)ul=X.$75l=eh(Th,wl);else if(Th instanceof l.Shape){_p=X.$74l=Hq(Th,wl);var pe=Th.getPoints();if(_p){var sb=_p.attachIndex,Jj=dm(Th,$.getDataUI(Th),sb)+1,Ol=Jj+1>=pe.size()?0:Jj+1,hj=pe.get(Jj),vf=pe.get(Ol),To=Th.p(),Me=Th.getRotation();hj=Sb(To,hj.x-To.x,hj.y-To.y,Me),vf=Sb(To,vf.x-To.x,vf.y-To.y,Me),Q.beginPath(),Q.strokeStyle=A,Q.lineWidth=i,Q.moveTo(hj.x*L,hj.y*L),Q.lineTo(vf.x*L,vf.y*L),Q.stroke()}}ul?Fk=ul.rect:(Fk=T.clone($.getDataUIBounds(Th)),T.grow(Fk,2)),Q.beginPath(),Q.rect(Fk.x*L,Fk.y*L,Fk.width*L,Fk.height*L),Q.strokeStyle=1===sj||4===sj||6===sj?_:M,Q.lineWidth=2,Q.setLineDash&&Q.setLineDash([8,8]),Q.stroke()}else delete X.$73l;wl.x=wl.x*L,wl.y=wl.y*L;var rk=Jp(Ng.x,Ng.y,wl.x,wl.y),Zn=Sb(Ng,wl.x-Ng.x,wl.y-Ng.y,-rk),xq=Zn.x-Ng.x;Q.save(),Q.translate(Ng.x,Ng.y),Q.rotate(rk),y.width=xq,y.height=40;var Dk=M;(1===sj||4===sj||6===sj)&&(Dk=_),y.comps[0].gradientColor=Dk,T.drawImage(Q,y,0,-20,xq,40),Q.restore()}}}if(n.each(function(p){var y=$.getDataUI(p);if(y){var w,g,S=y._55O,G=y._78o;if(S&&S._43O&&p instanceof x?(w=S.$15l,g=p.getSegments(),g&&g.size()||(g=He(w)),p.isClosePath()&&g.indexOf(5)<0&&(g=new j(g._as),g.add(5))):S&&G&&S._43O&&(w=p.s("edge.points"),g=p.s("edge.segments"),w=lp(y,w),g&&g.size()||(g=He(w)),w&&(w=w._as)),w&&g){var K=0,t=g.size(),P=X._hoverSegmentIndex;w=w.slice(0);for(var c=0;c<w.length;c++)w[c]=ur(w[c],L);Q.beginPath(),Q.strokeStyle=d,Q.lineWidth=1,K=0;for(var c=0;t>c;c++){var _=g.get(c);if(1===_||2===_)K++;else if(3===_){var m=w[K-1],q=w[K],F=w[K+1];Q.moveTo(m.x,m.y),Q.lineTo(q.x,q.y),Q.lineTo(F.x,F.y),K+=2}else if(4===_){var m=w[K-1],O=w[K],V=w[K+1],F=w[K+2];Q.moveTo(m.x,m.y),Q.lineTo(O.x,O.y),Q.moveTo(V.x,V.y),Q.lineTo(F.x,F.y),K+=3}}if(Q.stroke(),s===p||h===p&&"points"===h.s("edge.type")){Q.beginPath(),K=0,Q.strokeStyle=A,Q.lineWidth=i;for(var c=0;t>c;c++){var _=g.get(c);if(1===_||2===_){if(P===c){var m=w[K-1],F=w[K];Q.moveTo(m.x,m.y),Q.lineTo(F.x,F.y);break}K++}else if(3===_){if(P===c){var m=w[K-1],q=w[K],F=w[K+1];Q.moveTo(m.x,m.y),Q.quadraticCurveTo(q.x,q.y,F.x,F.y);break}K+=2}else if(4===_){if(P===c){var m=w[K-1],O=w[K],V=w[K+1],F=w[K+2];Q.moveTo(m.x,m.y),Q.bezierCurveTo(O.x,O.y,V.x,V.y,F.x,F.y);break}K+=3}else if(5===_&&P===c){var m=w[K-1],F=w[0];Q.moveTo(m.x,m.y),Q.lineTo(F.x,F.y);break}}Q.stroke()}Q.beginPath(),K=0,Q.strokeStyle=k,Q.lineWidth=1,Q.fillStyle=N;for(var c=0;t>c;c++){var _=g.get(c);if(1===_||2===_){var F=w[K];Q.moveTo(F.x+v,F.y),Q.arc(F.x,F.y,v,0,a,!0),K++}else if(3===_){var F=w[K+1];Q.moveTo(F.x+v,F.y),Q.arc(F.x,F.y,v,0,a,!0),K+=2}else if(4===_){var F=w[K+2];Q.moveTo(F.x+v,F.y),Q.arc(F.x,F.y,v,0,a,!0),K+=3}}Q.fill(),Q.stroke(),Q.beginPath(),K=0,Q.strokeStyle=W,Q.lineWidth=1,Q.fillStyle=o;for(var c=0;t>c;c++){var _=g.get(c);if(1===_||2===_)K++;else if(3===_){var q=w[K];Q.moveTo(q.x+v,q.y),Q.arc(q.x,q.y,v,0,a,!0),K+=2}else if(4===_){var O=w[K],V=w[K+1];Q.moveTo(O.x+v,O.y),Q.arc(O.x,O.y,v,0,a,!0),Q.moveTo(V.x+v,V.y),Q.arc(V.x,V.y,v,0,a,!0),K+=3}}if(Q.fill(),Q.stroke(),Q.beginPath(),K=0,Q.strokeStyle=B,Q.lineWidth=2,(s===p||h===p)&&X.$9l!=R){var F=w[X.$9l];Q.moveTo(F.x+v,F.y),Q.arc(F.x,F.y,v,0,a,!0),Q.stroke()}}}}),X.$87l&&$.sm().contains(X.$87l)){var Hk,Bk=X.$87l,Wr=X.$88l,gl=$.getEditHelperSize(),Dm=gl/2;if($.isHelperEditable(Bk,"pointElevation"))if(Bk instanceof x){var bc=Bk.getPosition();Hk=T.clone(Bk.getPoints().get(Wr)),Hk=Sb({x:bc.x,y:bc.y},Hk.x-bc.x,Hk.y-bc.y,Bk.getRotation()),Hk.x*=L,Hk.y*=L,Q.translate(Hk.x,Hk.y),T.drawImage(Q,T.getImage("xeditinteractor_elevationIcon"),Dm,-Dm,gl,gl),Q.translate(-Hk.x,-Hk.y),X._pointElevationHelperPoint={x:Hk.x+gl,y:Hk.y}}else if(Bk instanceof u){var Pj=lp($.getDataUI(Bk),Bk.s("edge.points")),Hk=T.clone(Pj.get(Wr));Hk.x*=L,Hk.y*=L,Q.translate(Hk.x,Hk.y),T.drawImage(Q,T.getImage("xeditinteractor_elevationIcon"),Dm,-Dm,gl,gl),Q.translate(-Hk.x,-Hk.y),X._pointElevationHelperPoint={x:Hk.x+gl,y:Hk.y}}}Q.restore(),X.$5l=0}},$89l:function(E,L,q,$){E.save();var d=this,z=d.gv,r=z.getEditHelperSize(),C=r/2;E.beginPath(),E.translate(q.x,q.y),E.rotate(L),T.drawImage(E,$,-C,-C,r,r),E.restore()},$85l:function(g,o,I){var i=this;i.$90l=I,i.$89l(g,o,I,T.getImage("xeditinteractor_elevationIcon"))},$86l:function(H,c,r){var K=this;K.$91l=r,K.$89l(H,c,r,T.getImage("xeditinteractor_tallIcon"))},$77l:function(i,r,E){var c=this;c.$68l=E,c.$89l(i,r,E,T.getImage("xeditinteractor_hostIcon"))},$80l:function(e,j,h){var D=this;D.$70l=h,D.$89l(e,j,h,T.getImage("xeditinteractor_edgeIcon"))},$81l:function(r,u,G){var E=this;E.$71l=G,E.$89l(r,u,G,T.getImage("xeditinteractor_removeIcon"))},$76l:function(W,w,i){var A=this;A.$69l=i,A.$89l(W,w,i,T.getImage("xeditinteractor_parentIcon"))},$84l:function(o,t,w,h,S){var i,$=this,K=$.gv,u=K.getZoom(),e=K.getEditHelperSize(),I=e/2;w.x*=u,w.y*=u,S&&(h?w.x-=I+5:w.x+=I+5),w.y-=e-2,h?($.$82l=w,i=T.getImage("xeditinteractor_sourceIcon")):($.$83l=w,i=T.getImage("xeditinteractor_targetIcon")),o.beginPath(),o.translate(w.x,w.y),T.drawImage(o,i,-I,-I,e,e),o.translate(-w.x,-w.y)},$44l:function(y,n,D){y.save();var A=this.gv.getZoom(),b=J(O(n.width,2)+O(n.height,2))/2*A+10,s=b,I=s+8,u=s+18,l=D,Y=n.x+n.width/2,Q=n.y+n.height/2;y.translate(Y*A,Q*A),y.beginPath(),y.strokeStyle="rgb(150, 150, 150)";for(var K=0,U=0,$=0,q=0,h=0,c=0;360>c;c++)K=c*E/180,0===c%5&&(U=w(K)*s,$=N(K)*s,q=w(K)*I,h=N(K)*I,y.moveTo(U,$),y.lineTo(q,h)),0===c%45&&(U=w(K)*s,$=N(K)*s,q=w(K)*u,h=N(K)*u,y.moveTo(U,$),y.lineTo(q,h));y.stroke(),y.beginPath(),y.rotate(-d),y.beginPath(),y.fillStyle="rgba(255, 0, 0, 0.1)",y.strokeStyle="rgb(157, 157, 157)",y.moveTo(0,0),y.arc(0,0,u,0,D,!1),y.fill(),y.beginPath(),y.moveTo(0+u,0),y.arc(0,0,u,0,D,!1),y.stroke(),y.rotate(d),y.font="bold 12px Verdana, Arial";var e=20*N(l),V=20*w(l),S=r(180*l/E)+"°";y.textAlign="center",y.textBaseline="middle",y.beginPath();var T=y.measureText("365.°").width;y.fillStyle="white",y.rect(e-T/2,-V-10,T,20),y.fill(),y.beginPath(),y.fillStyle="rgb(79,79,79)",y.fillText(S,e,-V),y.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);