!function(E,p){"use strict";var Q=ht.AlarmSeverity=function(z,b,A,N,D){this.value=z,this.name=b,this.nickName=A,this.color=N,this.displayName=D};ht.Default.def("ht.AlarmSeverity",p,{toString:function(){return this.displayName||this.name}}),function(){Q.severities=new ht.List,Q._vm={},Q._nm={},Q._cp=function(X,E){if(X&&E){var j=X.value-E.value;return j>0?1:0>j?-1:0}return X&&!E?1:!X&&E?-1:0},Q.each=function(N,G){Q.severities.each(N,G)},Q.getSortFunction=function(){return Q._cp},Q.setSortFunction=function(B){Q._cp=B,Q.severities.sort(B)},Q.add=function(q,F,y,x,s){var z=new Q(q,F,y,x,s);return Q._vm[q]=z,Q._nm[F]=z,Q.severities.add(z),Q.severities.sort(Q._cp),z},Q.remove=function(M){var V=Q._nm[M];return V&&(delete Q._nm[M],delete Q._vm[V.value],Q.severities.remove(V)),V},Q.CRITICAL=Q.add(500,"Critical","C","#FF0000"),Q.MAJOR=Q.add(400,"Major","M","#FFA000"),Q.MINOR=Q.add(300,"Minor","m","#FFFF00"),Q.WARNING=Q.add(200,"Warning","W","#00FFFF"),Q.INDETERMINATE=Q.add(100,"Indeterminate","N","#C800FF"),Q.CLEARED=Q.add(0,"Cleared","R","#00FF00"),Q.isClearedAlarmSeverity=function(Q){return Q?0===Q.value:!1},Q.getByName=function(y){return Q._nm[y]},Q.getByValue=function(r){return Q._vm[r]},Q.clear=function(){Q.severities.clear(),Q._vm={},Q._nm={}},Q.compare=function(i,R){return Q._cp(i,R)}}();var r=ht.AlarmState=function(Q){this._d=Q,this._nm={},this._am={},this._ps=null,this._haa=null,this._hna=null,this._hoa=null,this._hta=null,this._hls=!1,this._aac=0,this._nac=0};ht.Default.def("ht.AlarmState",p,{_ep:!0,_f:function(){this._c1(),this._c2(),this._c3(),this._c4(),this._c5(),this._c6(),this._c7(),this._d.fp("alarmState",null,this)},getHighestAcknowledgedAlarmSeverity:function(){return this._haa},getHighestNewAlarmSeverity:function(){return this._hna},getHighestOverallAlarmSeverity:function(){return this._hoa},getHighestNativeAlarmSeverity:function(){return this._hta},hasLessSevereNewAlarms:function(){return this._hls},_c1:function(){var q=null;for(var R in this._am)R=Q.getByName(R),Q.isClearedAlarmSeverity(R)||0!==this.getAcknowledgedAlarmCount(R)&&(q=q?Q.compare(q,R)>0?q:R:R);this._haa=q},_c2:function(){var D=null;for(var j in this._nm)j=Q.getByName(j),Q.isClearedAlarmSeverity(j)||0!==this.getNewAlarmCount(j)&&(D=D?Q.compare(D,j)>0?D:j:j);this._hna=D},_c3:function(){if(!this._hna)return this._hls=!1,void 0;for(var n in this._nm)if(n=Q.getByName(n),!Q.isClearedAlarmSeverity(n)&&0!==this.getNewAlarmCount(n)&&Q.compare(this._hna,n)>0)return this._hls=!0,void 0;this._hls=!1},_c4:function(){var M=this._haa,b=this._hna,w=this._ps;this._hoa=M,Q.compare(b,this._hoa)>0&&(this._hoa=b),Q.compare(w,this._hoa)>0&&(this._hoa=w)},_c5:function(){var I=this._haa,L=this._hna;this._hta=I,Q.compare(L,this._hta)>0&&(this._hta=L)},increaseAcknowledgedAlarm:function(G,v){if(0!==v){v=v||1;var J=this._am[G.name]||0;J+=v,this._am[G.name]=J,this._f()}},increaseNewAlarm:function(J,p){if(0!==p){p=p||1;var H=this._nm[J.name]||0;H+=p,this._nm[J.name]=H,this._f()}},decreaseAcknowledgedAlarm:function(G,K){if(0!==K){K||(K=1);var m=this._am[G.name]||0;if(m-=K,0>m)throw"Alarm count can not be negative";this._am[G.name]=m,this._f()}},decreaseNewAlarm:function(e,P){if(0!==P){P||(P=1);var K=this._nm[e.name]||0;if(K-=P,0>K)throw"Alarm count can not be negative";this._nm[e.name]=K,this._f()}},acknowledgeAlarm:function(c){this.decreaseNewAlarm(c,1),this.increaseAcknowledgedAlarm(c,1)},acknowledgeAllAlarms:function(r){if(r){var e=this.getNewAlarmCount(r);this.decreaseNewAlarm(r,e),this.increaseAcknowledgedAlarm(r,e)}else for(var B in this._nm)this.acknowledgeAllAlarms(Q.getByName(B))},_c6:function(){this._aac=0;for(var C in this._am)C=Q.getByName(C),this._aac+=this.getAcknowledgedAlarmCount(C)},getAcknowledgedAlarmCount:function(I){return I?this._am[I.name]||0:this._aac},getAlarmCount:function(L){return this.getAcknowledgedAlarmCount(L)+this.getNewAlarmCount(L)},_c7:function(){this._nac=0;for(var i in this._nm)this._nac+=this.getNewAlarmCount(Q.getByName(i))},getNewAlarmCount:function(x){return x?this._nm[x.name]||0:this._nac},setNewAlarmCount:function(l,L){this._nm[l.name]=L,this._f()},removeAllNewAlarms:function(k){k?delete this._nm[k]:this._nm={},this._f()},setAcknowledgedAlarmCount:function(x,l){this._am[x.name]=l,this._f()},removeAllAcknowledgedAlarms:function(g){g?delete this._am[g.name]:this._am={},this._f()},isEmpty:function(){return!this._hoa},clear:function(){this._am={},this._nm={},this._f()},getPropagateSeverity:function(){return this._ps},setPropagateSeverity:function(J){if(this._ep||(J=null),this._ps!==J){var O=this._ps;this._ps=J,this._f(),this._d.fp("propagateSeverity",O,J)}},isEnablePropagation:function(){return this._ep},setEnablePropagation:function(Q){var z=this._ep;this._ep=Q,this._d.fp("enablePropagation",z,Q)&&(Q||this.setPropagateSeverity(null))}});var H=ht.AlarmStatePropagator=function(x){this._dataModel=x,this._enable=!1,this._isPropagating=!1};ht.Default.def("ht.AlarmStatePropagator",p,{getDataModel:function(){return this._dataModel},isEnable:function(){return this._enable},setEnable:function(w){this._enable!==w&&(this._enable=w,this._enable?(this._dataModel.mm(this.handleDataModelChange,this),this._dataModel.md(this.handleDataPropertyChange,this),this._dataModel.each(function(l){this.propagate(l)},this)):(this._dataModel.umm(this.handleDataModelChange,this),this._dataModel.umd(this.handleDataPropertyChange,this)))},handleDataModelChange:function(c){c.data&&this.propagate(c.data)},handleDataPropertyChange:function(W){if("alarmState"===W.property||"enablePropagation"===W.property)this.propagate(W.data);else if("parent"===W.property){var t=W.oldValue;t&&this.propagate(t),this.propagate(W.data)}},propagate:function(G){G&&!this._isPropagating&&(this._isPropagating=!0,this.propagateToTop(G),this._isPropagating=!1)},propagateToTop:function(Y){for(this.propagateToParent(null,Y);Y&&Y.getParent();)this.propagateToParent(Y,Y.getParent()),Y=Y.getParent()},propagateToParent:function($,R){var c=null;R.getChildren().each(function(p){var w=p.getAlarmState().getHighestOverallAlarmSeverity();Q.compare(w,c)>0&&(c=w)}),R.getAlarmState().setPropagateSeverity(c)}}),ht.AlarmStateStatistics=function(N){this.sumNew=0,this.sumAcked=0,this.sumTotal=0,this.severtiyMap={},this.dataMap={},this.setDataModel(N)},ht.Default.def("ht.AlarmStateStatistics",p,{ms_fire:1,getDataModel:function(){return this._dataModel},setDataModel:function(Q){var J=this._dataModel;J!==Q&&(J&&(J.umd(this.handleDataPropertyChange,this),J.umm(this.handleDataModelChange,this),this.severtiyMap={},this.dataMap={}),this._dataModel=Q,this.reset(),Q.md(this.handleDataPropertyChange,this),Q.mm(this.handleDataModelChange,this),this.fp("dataModel",J,Q))},dispose:function(){this._dataModel.umd(this.handleDataPropertyChange,this),this._dataModel.umm(this.handleDataModelChange,this),delete this._dataModel},handleDataPropertyChange:function(o){"alarmState"===o.property&&(this.increase(o.data),this.fireAlarmStateChange())},handleDataModelChange:function(x){"add"===x.kind?(this.increase(x.data),this.fireAlarmStateChange()):"remove"===x.kind?(this.decrease(x.data),this.fireAlarmStateChange()):"clear"===x.kind&&(this.severtiyMap={},this.dataMap={},this.fireAlarmStateChange())},fireAlarmStateChange:function(){this.sumAcked=0,this.sumNew=0,this.sumTotal=0,Q.each(function(z){var a=this.getSumInfo(z);this.sumAcked+=a.ackedCount,this.sumNew+=a.newCount,this.sumTotal+=a.totalCount},this),this.fp("alarmState",!1,!0)},getNewAlarmCount:function(D){if(!D)return this.sumNew;var e=this.getSumInfo(D);return e.newCount},getAcknowledgedAlarmCount:function(J){if(!J)return this.sumAcked;var v=this.getSumInfo(J);return v.ackedCount},getTotalAlarmCount:function(n){if(!n)return this.sumTotal;var _=this.getSumInfo(n);return _.totalCount},getSumInfo:function(l){var Q=this.severtiyMap[l.name];return Q||(Q={},Q.newCount=0,Q.ackedCount=0,Q.totalCount=0,this.severtiyMap[l.name]=Q),Q},decrease:function(G){var T=this.dataMap[G.getId()];T&&(delete this.dataMap[G.getId()],Q.each(function(E){var A=T[E.name],G=this.getSumInfo(E);G.newCount=G.newCount-A.newCount,G.ackedCount=G.ackedCount-A.ackedCount,G.totalCount=G.totalCount-A.totalCount},this))},increase:function(h){if(this.decrease(h),!this._filterFunc||this._filterFunc(h)){var o={},l=h.getAlarmState();this.dataMap[h.getId()]=o,Q.each(function(f){var C={};C.newCount=l.getNewAlarmCount(f),C.ackedCount=l.getAcknowledgedAlarmCount(f),C.totalCount=l.getAlarmCount(f),o[f.name]=C;var J=this.getSumInfo(f);J.newCount=J.newCount+C.newCount,J.ackedCount=J.ackedCount+C.ackedCount,J.totalCount=J.totalCount+C.totalCount},this)}},reset:function(){this.severtiyMap={},this.dataMap={},this._dataModel.each(this.increase,this),this.fireAlarmStateChange()},setFilterFunc:function($){var i=this._filterFunc;this._filterFunc=$,this.reset(),this.fp("filterFunc",i,$)},getFilterFunc:function(){return this._filterFunc}});var G=ht.Data.prototype;G.getAlarmState=function(){return this._alarmState||(this._alarmState=new r(this))},G=ht.DataModel.prototype,G.isEnableAlarmStatePropagator=function(){return!!this._alarmStatePropagator&&this._alarmStatePropagator.isEnable()},G.setEnableAlarmStatePropagator=function(x){x!=this.isEnableAlarmStatePropagator()&&(x?(this._alarmStatePropagator=new H(this)).setEnable(!0):this._alarmStatePropagator.setEnable(!1))},G=ht.graph.GraphView.prototype,G.getNote2=function(m){var g=m.getAlarmState().getHighestNewAlarmSeverity();if(g){var J=m.getAlarmState().getNewAlarmCount(g)+g.nickName;return m.getAlarmState().hasLessSevereNewAlarms()&&(J+="+"),J}return m.s("note2")},G.getNote2Background=function(f){var c=f.getAlarmState().getHighestNewAlarmSeverity();return c?c.color:f.s("note2.background")},G.getBodyColor=function(Q){var J=Q.getAlarmState().getHighestNativeAlarmSeverity();return J?J.color:Q.s("body.color")},G.getBorderColor=function(I){var b=I.getAlarmState().getPropagateSeverity();return b?b.color:I.s("border.color")},G=ht.widget.TreeView.prototype,G.getBorderColor=function(u){var i=u.getAlarmState().getPropagateSeverity();return i?i.color:u.s("border.color")},G.getIcon=function(C){return C.getIcon()?"__alarmIcon__":null},G=ht.widget.TreeTableView.prototype,G.getBorderColor=function(J){var d=J.getAlarmState().getPropagateSeverity();return d?d.color:J.s("border.color")},G.getIcon=function(a){return a.getIcon()?"__alarmIcon__":null},ht.Default.setImage("__alarmIcon__",{width:16,height:16,comps:[{type:"image",name:{func:function(v){return v.getIcon()}},color:{func:function(Q){var h=Q.getAlarmState().getHighestNativeAlarmSeverity();return h?h.color:Q.s("body.color")}},rect:[0,0,16,16]}]});var T=ht.Style;T["note2.expanded"]=!0,T["note2.color"]="#000"}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);