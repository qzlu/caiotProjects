{
  "modified": "Mon Jan 28 2019 11:13:44 GMT+0800 (中国标准时间)",
  "width": 300,
  "height": 180,
  "snapshotURL": "",
  "func": "__ht__function(g, rect, comp, data, view) {\nvar colors = comp.getValue('colors'),\n    labelColor = comp.getValue('labelColor'),\n    dataset = comp.getValue('dataset'),\n    font = comp.getValue('font'),\n    max = comp.getValue('max'),\n    barPercent = comp.getValue('barPercent');\n\nif (!dataset.length) return;\n\nvar x = rect.x,\n    y = rect.y,\n    width = rect.width,\n    height = rect.height;\n\nvar barHeight = height / dataset.length * barPercent,\n    rowHeight = height / dataset.length,\n    gap = (rowHeight - barHeight) / 2,\n    labelWidth = 0,\n    labelGap = 5,\n    valueLabelWidth = 48,\n    textSizes = [],\n    needJudgeMax = max === undefined,\n    max = needJudgeMax ? - Infinity : max;\n// 计算文本宽度\ndataset.forEach(function(item) {\n    var size = ht.Default.getTextSize(font, item.name);\n    labelWidth = Math.max(labelWidth, size.width);\n    textSizes.push(textSizes);\n    if (needJudgeMax) {\n        max = Math.max(max, item.value);\n    }\n});\n\nvar barWidth = width - labelWidth - labelGap * 2 - valueLabelWidth,\n    dy = y,\n    dx = x;\ndataset.forEach(function(item, index) {\n    dx = x;\n    // 标签文本\n    var size = textSizes[index];\n    ht.Default.drawText(g, item.name, font, labelColor,\n            dx, dy, size.width, rowHeight, 'left', 'middle');\n\n    // 柱子\n    dx += labelWidth + labelGap;\n    var percent = item.value / max;\n    percent = Math.min(percent, 1);\n    g.fillStyle = colors[index % colors.length];\n    g.fillRect(dx, dy + gap, barWidth * percent, barHeight);\n    // 值文本\n    dx += barWidth * percent + labelGap;\n    ht.Default.drawText(g, item.value + '', font, labelColor,\n            dx, dy, valueLabelWidth, rowHeight, 'left', 'middle');\n    dy += rowHeight;\n});\n}",
  "properties": {
    "dataset": {
      "valueType": "Object",
      "defaultValue": [
        {
          "name": "一级隐患",
          "value": 43
        },
        {
          "name": "二级隐患",
          "value": 12
        },
        {
          "name": "三级隐患",
          "value": 56
        },
        {
          "name": "四级隐患",
          "value": 100
        }
      ],
      "name": "数据"
    },
    "colors": {
      "valueType": "ColorArray",
      "defaultValue": [
        "rgb(0,199,7)",
        "#FEB64D",
        "rgb(214,93,0)",
        "rgb(217,29,20)"
      ],
      "name": "颜色组"
    },
    "font": {
      "valueType": "Font",
      "defaultValue": "16px sans-serif, Arial",
      "name": "字体"
    },
    "labelColor": {
      "valueType": "Color",
      "defaultValue": "rgb(0,229,255)",
      "name": "文本颜色"
    },
    "max": {
      "valueType": "Number",
      "name": "最大值"
    },
    "barPercent": {
      "valueType": "Percentage",
      "defaultValue": 0.75,
      "name": "柱宽度占比"
    }
  }
}